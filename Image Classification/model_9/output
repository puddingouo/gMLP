<<<<<<< HEAD
 CPU平衡版 gMLP 圖像分類測試
============================================================
⚖️ 平衡效率與準確度 - 提升模型性能
============================================================
📦 加載CPU優化的 CIFAR-10 數據集...
   🛡️ CPU防過擬合模式：增加數據量提升泛化能力
   ✓ 訓練樣本: 5000
   ✓ 測試樣本: 1000
   ✓ 類別數: 10
   ✓ CPU防過擬合優化: batch_size=64, 大數據量防過擬合

🏗️ 創建CPU優化的 gMLP 模型...
   ⚡ CPU模式：已設置4個線程
   ✓ CPU平衡模型創建完成
   ✓ 設備: cpu
   ✓ 參數數量: 2,016,586
   ✓ 模型大小: 7.7 MB
   ✓ 準確度優化: patch_size=4, dim=256, depth=5

🏋️ 開始CPU平衡訓練 (100 個 epochs)...

Epoch 1/100, LR: 0.000040
   批次  15/79: 損失 = 2.3011, 準確率 = 11.35%, 學習率 = 0.000041
   批次  30/79: 損失 = 2.2639, 準確率 = 14.90%, 學習率 = 0.000043
   批次  45/79: 損失 = 2.2441, 準確率 = 17.29%, 學習率 = 0.000048
   批次  60/79: 損失 = 2.2325, 準確率 = 18.67%, 學習率 = 0.000054
   批次  75/79: 損失 = 2.2263, 準確率 = 19.06%, 學習率 = 0.000061
   批次  79/79: 損失 = 2.2231, 準確率 = 19.40%, 學習率 = 0.000064
Epoch 1 完成: 訓練準確率 = 19.40%, 驗證準確率 = 18.90%, 時間 = 56.79s

Epoch 2/100, LR: 0.000064
   批次  15/79: 損失 = 2.1943, 準確率 = 20.52%, 學習率 = 0.000073
   批次  30/79: 損失 = 2.1764, 準確率 = 22.81%, 學習率 = 0.000085
   批次  45/79: 損失 = 2.1704, 準確率 = 23.89%, 學習率 = 0.000097
   批次  60/79: 損失 = 2.1668, 準確率 = 24.22%, 學習率 = 0.000112
   批次  75/79: 損失 = 2.1664, 準確率 = 24.23%, 學習率 = 0.000127
   批次  79/79: 損失 = 2.1681, 準確率 = 24.28%, 學習率 = 0.000132
Epoch 2 完成: 訓練準確率 = 24.28%, 驗證準確率 = 26.90%, 時間 = 54.84s

Epoch 3/100, LR: 0.000132
   批次  15/79: 損失 = 2.1314, 準確率 = 27.40%, 學習率 = 0.000149
   批次  30/79: 損失 = 2.1363, 準確率 = 26.82%, 學習率 = 0.000168
   批次  45/79: 損失 = 2.1302, 準確率 = 27.50%, 學習率 = 0.000188
   批次  60/79: 損失 = 2.1294, 準確率 = 27.97%, 學習率 = 0.000210
   批次  75/79: 損失 = 2.1253, 準確率 = 28.60%, 學習率 = 0.000232
   批次  79/79: 損失 = 2.1238, 準確率 = 28.80%, 學習率 = 0.000238
Epoch 3 完成: 訓練準確率 = 28.80%, 驗證準確率 = 29.80%, 時間 = 56.49s

Epoch 4/100, LR: 0.000238
   批次  15/79: 損失 = 2.0898, 準確率 = 32.29%, 學習率 = 0.000262
   批次  30/79: 損失 = 2.0864, 準確率 = 31.72%, 學習率 = 0.000287
   批次  45/79: 損失 = 2.0839, 準確率 = 32.12%, 學習率 = 0.000312
   批次  60/79: 損失 = 2.0837, 準確率 = 31.67%, 學習率 = 0.000338
   批次  75/79: 損失 = 2.0788, 準確率 = 31.94%, 學習率 = 0.000365
   批次  79/79: 損失 = 2.0826, 準確率 = 31.88%, 學習率 = 0.000372
Epoch 4 完成: 訓練準確率 = 31.88%, 驗證準確率 = 36.30%, 時間 = 56.26s

Epoch 5/100, LR: 0.000372
   批次  15/79: 損失 = 2.0551, 準確率 = 34.27%, 學習率 = 0.000400
   批次  30/79: 損失 = 2.0384, 準確率 = 36.35%, 學習率 = 0.000428
   批次  45/79: 損失 = 2.0455, 準確率 = 35.28%, 學習率 = 0.000456
   批次  60/79: 損失 = 2.0430, 準確率 = 35.60%, 學習率 = 0.000485
   批次  75/79: 損失 = 2.0444, 準確率 = 35.65%, 學習率 = 0.000513
   批次  79/79: 損失 = 2.0431, 準確率 = 35.64%, 學習率 = 0.000521
Epoch 5 完成: 訓練準確率 = 35.64%, 驗證準確率 = 35.70%, 時間 = 61.69s

Epoch 6/100, LR: 0.000521
   批次  15/79: 損失 = 2.0458, 準確率 = 35.31%, 學習率 = 0.000550
   批次  30/79: 損失 = 2.0323, 準確率 = 36.46%, 學習率 = 0.000578
   批次  45/79: 損失 = 2.0279, 準確率 = 36.88%, 學習率 = 0.000606
   批次  60/79: 損失 = 2.0255, 準確率 = 37.03%, 學習率 = 0.000635
   批次  75/79: 損失 = 2.0271, 準確率 = 36.75%, 學習率 = 0.000662
   批次  79/79: 損失 = 2.0225, 準確率 = 37.12%, 學習率 = 0.000669
Epoch 6 完成: 訓練準確率 = 37.12%, 驗證準確率 = 38.50%, 時間 = 55.69s

Epoch 7/100, LR: 0.000669
   批次  15/79: 損失 = 2.0072, 準確率 = 38.12%, 學習率 = 0.000696
   批次  30/79: 損失 = 2.0061, 準確率 = 37.66%, 學習率 = 0.000723
   批次  45/79: 損失 = 2.0037, 準確率 = 37.92%, 學習率 = 0.000748
   批次  60/79: 損失 = 2.0018, 準確率 = 38.46%, 學習率 = 0.000773
   批次  75/79: 損失 = 2.0028, 準確率 = 38.50%, 學習率 = 0.000797
   批次  79/79: 損失 = 2.0001, 準確率 = 38.74%, 學習率 = 0.000803
Epoch 7 完成: 訓練準確率 = 38.74%, 驗證準確率 = 46.00%, 時間 = 55.77s

Epoch 8/100, LR: 0.000803
   批次  15/79: 損失 = 1.9585, 準確率 = 42.92%, 學習率 = 0.000826
   批次  30/79: 損失 = 1.9653, 準確率 = 42.71%, 學習率 = 0.000847
   批次  45/79: 損失 = 1.9681, 準確率 = 43.02%, 學習率 = 0.000868
   批次  60/79: 損失 = 1.9703, 準確率 = 42.73%, 學習率 = 0.000887
   批次  75/79: 損失 = 1.9722, 準確率 = 42.35%, 學習率 = 0.000905
   批次  79/79: 損失 = 1.9703, 準確率 = 42.30%, 學習率 = 0.000909
Epoch 8 完成: 訓練準確率 = 42.30%, 驗證準確率 = 47.00%, 時間 = 58.08s

Epoch 9/100, LR: 0.000909
   批次  15/79: 損失 = 1.9458, 準確率 = 42.60%, 學習率 = 0.000925
   批次  30/79: 損失 = 1.9244, 準確率 = 45.42%, 學習率 = 0.000940
   批次  45/79: 損失 = 1.9305, 準確率 = 44.86%, 學習率 = 0.000953
   批次  60/79: 損失 = 1.9316, 準確率 = 45.18%, 學習率 = 0.000965
   批次  75/79: 損失 = 1.9370, 準確率 = 44.75%, 學習率 = 0.000975
   批次  79/79: 損失 = 1.9393, 準確率 = 44.62%, 學習率 = 0.000977
Epoch 9 完成: 訓練準確率 = 44.62%, 驗證準確率 = 48.00%, 時間 = 57.91s

Epoch 10/100, LR: 0.000977
   批次  15/79: 損失 = 1.9327, 準確率 = 45.10%, 學習率 = 0.000985
   批次  30/79: 損失 = 1.9313, 準確率 = 45.83%, 學習率 = 0.000991
   批次  45/79: 損失 = 1.9342, 準確率 = 45.49%, 學習率 = 0.000996
   批次  60/79: 損失 = 1.9304, 準確率 = 45.60%, 學習率 = 0.000999
   批次  75/79: 損失 = 1.9264, 準確率 = 46.27%, 學習率 = 0.001000
   批次  79/79: 損失 = 1.9283, 準確率 = 46.32%, 學習率 = 0.001000
Epoch 10 完成: 訓練準確率 = 46.32%, 驗證準確率 = 49.20%, 時間 = 57.41s

Epoch 11/100, LR: 0.001000
   批次  15/79: 損失 = 1.9007, 準確率 = 48.23%, 學習率 = 0.001000
   批次  30/79: 損失 = 1.8952, 準確率 = 48.59%, 學習率 = 0.001000
   批次  45/79: 損失 = 1.8911, 準確率 = 49.17%, 學習率 = 0.001000
   批次  60/79: 損失 = 1.8941, 準確率 = 48.46%, 學習率 = 0.001000
   批次  75/79: 損失 = 1.9046, 準確率 = 47.65%, 學習率 = 0.001000
   批次  79/79: 損失 = 1.9035, 準確率 = 47.64%, 學習率 = 0.001000
Epoch 11 完成: 訓練準確率 = 47.64%, 驗證準確率 = 51.50%, 時間 = 60.14s
   🔄 已完成10%訓練，目前最佳驗證準確率: 49.20%

Epoch 12/100, LR: 0.001000
   批次  15/79: 損失 = 1.8785, 準確率 = 47.50%, 學習率 = 0.001000
   批次  30/79: 損失 = 1.8697, 準確率 = 49.79%, 學習率 = 0.000999
   批次  45/79: 損失 = 1.8714, 準確率 = 49.44%, 學習率 = 0.000999
   批次  60/79: 損失 = 1.8716, 準確率 = 49.58%, 學習率 = 0.000999
   批次  75/79: 損失 = 1.8790, 準確率 = 49.17%, 學習率 = 0.000999
   批次  79/79: 損失 = 1.8767, 準確率 = 49.56%, 學習率 = 0.000999
Epoch 12 完成: 訓練準確率 = 49.56%, 驗證準確率 = 51.00%, 時間 = 63.59s

Epoch 13/100, LR: 0.000999
   批次  15/79: 損失 = 1.9001, 準確率 = 49.79%, 學習率 = 0.000999
   批次  30/79: 損失 = 1.8897, 準確率 = 50.10%, 學習率 = 0.000998
   批次  45/79: 損失 = 1.8836, 準確率 = 50.03%, 學習率 = 0.000998
   批次  60/79: 損失 = 1.8784, 準確率 = 50.36%, 學習率 = 0.000998
   批次  75/79: 損失 = 1.8764, 準確率 = 50.21%, 學習率 = 0.000997
   批次  79/79: 損失 = 1.8772, 準確率 = 50.30%, 學習率 = 0.000997
Epoch 13 完成: 訓練準確率 = 50.30%, 驗證準確率 = 50.80%, 時間 = 56.14s

Epoch 14/100, LR: 0.000997
   批次  15/79: 損失 = 1.8770, 準確率 = 50.73%, 學習率 = 0.000997
   批次  30/79: 損失 = 1.8651, 準確率 = 50.68%, 學習率 = 0.000996
   批次  45/79: 損失 = 1.8513, 準確率 = 51.84%, 學習率 = 0.000996
   批次  60/79: 損失 = 1.8573, 準確率 = 51.64%, 學習率 = 0.000996
   批次  75/79: 損失 = 1.8532, 準確率 = 52.04%, 學習率 = 0.000995
   批次  79/79: 損失 = 1.8572, 準確率 = 51.52%, 學習率 = 0.000995
Epoch 14 完成: 訓練準確率 = 51.52%, 驗證準確率 = 54.00%, 時間 = 60.10s

Epoch 15/100, LR: 0.000995
   批次  15/79: 損失 = 1.8309, 準確率 = 53.02%, 學習率 = 0.000995
   批次  30/79: 損失 = 1.8247, 準確率 = 53.70%, 學習率 = 0.000994
   批次  45/79: 損失 = 1.8358, 準確率 = 53.26%, 學習率 = 0.000994
   批次  60/79: 損失 = 1.8388, 準確率 = 53.07%, 學習率 = 0.000993
   批次  75/79: 損失 = 1.8342, 準確率 = 53.27%, 學習率 = 0.000993
   批次  79/79: 損失 = 1.8357, 準確率 = 53.30%, 學習率 = 0.000992
Epoch 15 完成: 訓練準確率 = 53.30%, 驗證準確率 = 53.90%, 時間 = 59.78s

Epoch 16/100, LR: 0.000992
   批次  15/79: 損失 = 1.8413, 準確率 = 51.67%, 學習率 = 0.000992
   批次  30/79: 損失 = 1.8339, 準確率 = 53.75%, 學習率 = 0.000991
   批次  45/79: 損失 = 1.8375, 準確率 = 53.75%, 學習率 = 0.000991
   批次  60/79: 損失 = 1.8271, 準確率 = 54.56%, 學習率 = 0.000990
   批次  75/79: 損失 = 1.8214, 準確率 = 55.29%, 學習率 = 0.000989
   批次  79/79: 損失 = 1.8242, 準確率 = 55.18%, 學習率 = 0.000989
Epoch 16 完成: 訓練準確率 = 55.18%, 驗證準確率 = 54.20%, 時間 = 63.26s

Epoch 17/100, LR: 0.000989
   批次  15/79: 損失 = 1.8119, 準確率 = 53.75%, 學習率 = 0.000988
   批次  30/79: 損失 = 1.8056, 準確率 = 55.62%, 學習率 = 0.000988
   批次  45/79: 損失 = 1.8006, 準確率 = 55.97%, 學習率 = 0.000987
   批次  60/79: 損失 = 1.7974, 準確率 = 56.25%, 學習率 = 0.000986
   批次  75/79: 損失 = 1.8021, 準確率 = 55.90%, 學習率 = 0.000985
   批次  79/79: 損失 = 1.8029, 準確率 = 55.70%, 學習率 = 0.000985
Epoch 17 完成: 訓練準確率 = 55.70%, 驗證準確率 = 54.50%, 時間 = 57.06s

Epoch 18/100, LR: 0.000985
   批次  15/79: 損失 = 1.7944, 準確率 = 56.88%, 學習率 = 0.000984
   批次  30/79: 損失 = 1.8069, 準確率 = 55.83%, 學習率 = 0.000983
   批次  45/79: 損失 = 1.8001, 準確率 = 56.32%, 學習率 = 0.000983
   批次  60/79: 損失 = 1.8106, 準確率 = 55.29%, 學習率 = 0.000982
   批次  75/79: 損失 = 1.8063, 準確率 = 55.75%, 學習率 = 0.000981
   批次  79/79: 損失 = 1.8094, 準確率 = 55.74%, 學習率 = 0.000981
Epoch 18 完成: 訓練準確率 = 55.74%, 驗證準確率 = 57.60%, 時間 = 57.85s

Epoch 19/100, LR: 0.000981
   批次  15/79: 損失 = 1.8062, 準確率 = 55.94%, 學習率 = 0.000980
   批次  30/79: 損失 = 1.7999, 準確率 = 57.24%, 學習率 = 0.000979
   批次  45/79: 損失 = 1.7930, 準確率 = 57.88%, 學習率 = 0.000978
   批次  60/79: 損失 = 1.7908, 準確率 = 57.81%, 學習率 = 0.000977
   批次  75/79: 損失 = 1.7892, 準確率 = 57.98%, 學習率 = 0.000976
   批次  79/79: 損失 = 1.7925, 準確率 = 57.74%, 學習率 = 0.000975
Epoch 19 完成: 訓練準確率 = 57.74%, 驗證準確率 = 56.70%, 時間 = 75.49s

Epoch 20/100, LR: 0.000975
   批次  15/79: 損失 = 1.8015, 準確率 = 56.04%, 學習率 = 0.000974
   批次  30/79: 損失 = 1.8126, 準確率 = 53.96%, 學習率 = 0.000973
   批次  45/79: 損失 = 1.8018, 準確率 = 55.14%, 學習率 = 0.000972
   批次  60/79: 損失 = 1.7913, 準確率 = 56.43%, 學習率 = 0.000971
   批次  75/79: 損失 = 1.7923, 準確率 = 56.52%, 學習率 = 0.000970
   批次  79/79: 損失 = 1.7919, 準確率 = 56.50%, 學習率 = 0.000970
Epoch 20 完成: 訓練準確率 = 56.50%, 驗證準確率 = 56.60%, 時間 = 58.78s

Epoch 21/100, LR: 0.000970
   批次  15/79: 損失 = 1.7987, 準確率 = 55.21%, 學習率 = 0.000969
   批次  30/79: 損失 = 1.7988, 準確率 = 56.15%, 學習率 = 0.000967
   批次  45/79: 損失 = 1.7880, 準確率 = 57.19%, 學習率 = 0.000966
   批次  60/79: 損失 = 1.7803, 準確率 = 57.76%, 學習率 = 0.000965
   批次  75/79: 損失 = 1.7829, 準確率 = 57.40%, 學習率 = 0.000964
   批次  79/79: 損失 = 1.7789, 準確率 = 57.70%, 學習率 = 0.000964
Epoch 21 完成: 訓練準確率 = 57.70%, 驗證準確率 = 56.60%, 時間 = 57.97s

Epoch 22/100, LR: 0.000964
   批次  15/79: 損失 = 1.7406, 準確率 = 60.21%, 學習率 = 0.000962
   批次  30/79: 損失 = 1.7545, 準確率 = 58.96%, 學習率 = 0.000961
   批次  45/79: 損失 = 1.7652, 準確率 = 58.72%, 學習率 = 0.000960
   批次  60/79: 損失 = 1.7620, 準確率 = 58.67%, 學習率 = 0.000958
   批次  75/79: 損失 = 1.7674, 準確率 = 58.19%, 學習率 = 0.000957
   批次  79/79: 損失 = 1.7664, 準確率 = 58.38%, 學習率 = 0.000957
Epoch 22 完成: 訓練準確率 = 58.38%, 驗證準確率 = 57.60%, 時間 = 58.89s

Epoch 23/100, LR: 0.000957
   批次  15/79: 損失 = 1.7769, 準確率 = 57.60%, 學習率 = 0.000955
   批次  30/79: 損失 = 1.7519, 準確率 = 60.26%, 學習率 = 0.000954
   批次  45/79: 損失 = 1.7461, 準確率 = 59.83%, 學習率 = 0.000953
   批次  60/79: 損失 = 1.7519, 準確率 = 59.22%, 學習率 = 0.000951
   批次  75/79: 損失 = 1.7479, 準確率 = 59.54%, 學習率 = 0.000950
   批次  79/79: 損失 = 1.7462, 準確率 = 59.80%, 學習率 = 0.000949
Epoch 23 完成: 訓練準確率 = 59.80%, 驗證準確率 = 57.90%, 時間 = 62.84s

Epoch 24/100, LR: 0.000949
   批次  15/79: 損失 = 1.7380, 準確率 = 61.25%, 學習率 = 0.000948
   批次  30/79: 損失 = 1.7337, 準確率 = 61.56%, 學習率 = 0.000946
   批次  45/79: 損失 = 1.7390, 準確率 = 60.83%, 學習率 = 0.000945
   批次  60/79: 損失 = 1.7429, 準確率 = 61.12%, 學習率 = 0.000943
   批次  75/79: 損失 = 1.7339, 準確率 = 61.96%, 學習率 = 0.000942
   批次  79/79: 損失 = 1.7378, 準確率 = 61.64%, 學習率 = 0.000941
Epoch 24 完成: 訓練準確率 = 61.64%, 驗證準確率 = 58.10%, 時間 = 56.69s

Epoch 25/100, LR: 0.000941
   批次  15/79: 損失 = 1.7552, 準確率 = 59.90%, 學習率 = 0.000940
   批次  30/79: 損失 = 1.7293, 準確率 = 61.77%, 學習率 = 0.000938
   批次  45/79: 損失 = 1.7420, 準確率 = 61.01%, 學習率 = 0.000937
   批次  60/79: 損失 = 1.7450, 準確率 = 60.94%, 學習率 = 0.000935
   批次  75/79: 損失 = 1.7450, 準確率 = 60.79%, 學習率 = 0.000933
   批次  79/79: 損失 = 1.7476, 準確率 = 60.86%, 學習率 = 0.000933
Epoch 25 完成: 訓練準確率 = 60.86%, 驗證準確率 = 58.70%, 時間 = 56.24s

Epoch 26/100, LR: 0.000933
   批次  15/79: 損失 = 1.6688, 準確率 = 64.69%, 學習率 = 0.000931
   批次  30/79: 損失 = 1.7027, 準確率 = 62.76%, 學習率 = 0.000930
   批次  45/79: 損失 = 1.7194, 準確率 = 62.36%, 學習率 = 0.000928
   批次  60/79: 損失 = 1.7133, 準確率 = 62.92%, 學習率 = 0.000926
   批次  75/79: 損失 = 1.7174, 準確率 = 62.73%, 學習率 = 0.000924
   批次  75/79: 損失 = 1.7174, 準確率 = 62.73%, 學習率 = 0.000924
   批次  79/79: 損失 = 1.7224, 準確率 = 62.62%, 學習率 = 0.000924
Epoch 26 完成: 訓練準確率 = 62.62%, 驗證準確率 = 60.30%, 時間 = 63.26s
   🔄 已完成25%訓練，目前最佳驗證準確率: 58.70%

Epoch 27/100, LR: 0.000924
   批次  15/79: 損失 = 1.6887, 準確率 = 64.69%, 學習率 = 0.000922
   批次  30/79: 損失 = 1.7058, 準確率 = 63.49%, 學習率 = 0.000920
   批次  45/79: 損失 = 1.7079, 準確率 = 62.95%, 學習率 = 0.000919
   批次  60/79: 損失 = 1.7116, 準確率 = 62.79%, 學習率 = 0.000917
   批次  75/79: 損失 = 1.7159, 準確率 = 62.90%, 學習率 = 0.000915
   批次  79/79: 損失 = 1.7192, 準確率 = 62.68%, 學習率 = 0.000914
Epoch 27 完成: 訓練準確率 = 62.68%, 驗證準確率 = 60.10%, 時間 = 84.19s

Epoch 28/100, LR: 0.000914
   批次  15/79: 損失 = 1.6910, 準確率 = 64.27%, 學習率 = 0.000913
   批次  30/79: 損失 = 1.7137, 準確率 = 62.14%, 學習率 = 0.000911
   批次  45/79: 損失 = 1.7096, 準確率 = 62.88%, 學習率 = 0.000909
   批次  60/79: 損失 = 1.7060, 準確率 = 63.44%, 學習率 = 0.000907
   批次  75/79: 損失 = 1.7094, 準確率 = 63.50%, 學習率 = 0.000905
   批次  79/79: 損失 = 1.7091, 準確率 = 63.28%, 學習率 = 0.000904
Epoch 28 完成: 訓練準確率 = 63.28%, 驗證準確率 = 61.30%, 時間 = 63.13s

Epoch 29/100, LR: 0.000904
   批次  15/79: 損失 = 1.7042, 準確率 = 64.27%, 學習率 = 0.000902
   批次  30/79: 損失 = 1.6939, 準確率 = 65.00%, 學習率 = 0.000900
   批次  45/79: 損失 = 1.6824, 準確率 = 65.66%, 學習率 = 0.000898
   批次  60/79: 損失 = 1.6795, 準確率 = 65.99%, 學習率 = 0.000896
   批次  75/79: 損失 = 1.6880, 準確率 = 65.38%, 學習率 = 0.000894
   批次  79/79: 損失 = 1.6858, 準確率 = 65.24%, 學習率 = 0.000894
Epoch 29 完成: 訓練準確率 = 65.24%, 驗證準確率 = 61.00%, 時間 = 52.48s

Epoch 30/100, LR: 0.000894
   批次  15/79: 損失 = 1.7105, 準確率 = 62.92%, 學習率 = 0.000892
   批次  30/79: 損失 = 1.7049, 準確率 = 63.07%, 學習率 = 0.000890
   批次  45/79: 損失 = 1.7133, 準確率 = 62.92%, 學習率 = 0.000888
   批次  60/79: 損失 = 1.7054, 準確率 = 63.75%, 學習率 = 0.000886
   批次  75/79: 損失 = 1.7018, 準確率 = 63.94%, 學習率 = 0.000883
   批次  79/79: 損失 = 1.6950, 準確率 = 64.24%, 學習率 = 0.000883
Epoch 30 完成: 訓練準確率 = 64.24%, 驗證準確率 = 60.10%, 時間 = 55.56s

Epoch 31/100, LR: 0.000883
   批次  15/79: 損失 = 1.6777, 準確率 = 66.46%, 學習率 = 0.000881
   批次  30/79: 損失 = 1.6824, 準確率 = 65.00%, 學習率 = 0.000879
   批次  45/79: 損失 = 1.6809, 準確率 = 65.52%, 學習率 = 0.000876
   批次  60/79: 損失 = 1.6791, 準確率 = 65.81%, 學習率 = 0.000874
   批次  75/79: 損失 = 1.6838, 準確率 = 65.62%, 學習率 = 0.000872
   批次  79/79: 損失 = 1.6845, 準確率 = 65.46%, 學習率 = 0.000871
Epoch 31 完成: 訓練準確率 = 65.46%, 驗證準確率 = 61.50%, 時間 = 51.34s

Epoch 32/100, LR: 0.000871
   批次  15/79: 損失 = 1.6289, 準確率 = 68.44%, 學習率 = 0.000869
   批次  30/79: 損失 = 1.6527, 準確率 = 67.76%, 學習率 = 0.000867
   批次  45/79: 損失 = 1.6510, 準確率 = 68.02%, 學習率 = 0.000865
   批次  60/79: 損失 = 1.6604, 準確率 = 67.19%, 學習率 = 0.000862
   批次  75/79: 損失 = 1.6732, 準確率 = 66.79%, 學習率 = 0.000860
   批次  79/79: 損失 = 1.6733, 準確率 = 66.84%, 學習率 = 0.000860
Epoch 32 完成: 訓練準確率 = 66.84%, 驗證準確率 = 64.20%, 時間 = 53.13s

Epoch 33/100, LR: 0.000860
   批次  15/79: 損失 = 1.6394, 準確率 = 69.48%, 學習率 = 0.000857
   批次  30/79: 損失 = 1.6591, 準確率 = 66.72%, 學習率 = 0.000855
   批次  45/79: 損失 = 1.6562, 準確率 = 67.43%, 學習率 = 0.000853
   批次  60/79: 損失 = 1.6523, 準確率 = 67.63%, 學習率 = 0.000850
   批次  75/79: 損失 = 1.6564, 準確率 = 67.19%, 學習率 = 0.000848
   批次  79/79: 損失 = 1.6565, 準確率 = 67.10%, 學習率 = 0.000847
Epoch 33 完成: 訓練準確率 = 67.10%, 驗證準確率 = 61.20%, 時間 = 58.29s

Epoch 34/100, LR: 0.000847
   批次  15/79: 損失 = 1.6151, 準確率 = 70.10%, 學習率 = 0.000845
   批次  30/79: 損失 = 1.6230, 準確率 = 69.64%, 學習率 = 0.000842
   批次  45/79: 損失 = 1.6242, 準確率 = 70.24%, 學習率 = 0.000840
   批次  60/79: 損失 = 1.6295, 準確率 = 69.61%, 學習率 = 0.000838
   批次  75/79: 損失 = 1.6408, 準確率 = 68.96%, 學習率 = 0.000835
   批次  79/79: 損失 = 1.6449, 準確率 = 68.72%, 學習率 = 0.000834
Epoch 34 完成: 訓練準確率 = 68.72%, 驗證準確率 = 61.10%, 時間 = 51.39s

Epoch 35/100, LR: 0.000834
   批次  15/79: 損失 = 1.6032, 準確率 = 72.19%, 學習率 = 0.000832
   批次  30/79: 損失 = 1.6139, 準確率 = 70.89%, 學習率 = 0.000830
   批次  45/79: 損失 = 1.6288, 準確率 = 69.76%, 學習率 = 0.000827
   批次  60/79: 損失 = 1.6315, 準確率 = 69.43%, 學習率 = 0.000825
   批次  75/79: 損失 = 1.6370, 準確率 = 68.94%, 學習率 = 0.000822
   批次  79/79: 損失 = 1.6352, 準確率 = 68.96%, 學習率 = 0.000821
Epoch 35 完成: 訓練準確率 = 68.96%, 驗證準確率 = 61.90%, 時間 = 54.53s

Epoch 36/100, LR: 0.000821
   批次  15/79: 損失 = 1.6075, 準確率 = 72.40%, 學習率 = 0.000819
   批次  30/79: 損失 = 1.6346, 準確率 = 69.06%, 學習率 = 0.000816
   批次  45/79: 損失 = 1.6260, 準確率 = 69.65%, 學習率 = 0.000814
   批次  60/79: 損失 = 1.6264, 準確率 = 69.64%, 學習率 = 0.000811
   批次  75/79: 損失 = 1.6332, 準確率 = 69.06%, 學習率 = 0.000808
   批次  79/79: 損失 = 1.6366, 準確率 = 68.64%, 學習率 = 0.000808
Epoch 36 完成: 訓練準確率 = 68.64%, 驗證準確率 = 60.40%, 時間 = 59.81s

Epoch 37/100, LR: 0.000808
   批次  15/79: 損失 = 1.5863, 準確率 = 73.12%, 學習率 = 0.000805
   批次  30/79: 損失 = 1.5945, 準確率 = 72.29%, 學習率 = 0.000802
   批次  45/79: 損失 = 1.6165, 準確率 = 70.49%, 學習率 = 0.000800
   批次  60/79: 損失 = 1.6211, 準確率 = 69.90%, 學習率 = 0.000797
   批次  75/79: 損失 = 1.6235, 準確率 = 69.65%, 學習率 = 0.000795
   批次  79/79: 損失 = 1.6233, 準確率 = 69.56%, 學習率 = 0.000794
Epoch 37 完成: 訓練準確率 = 69.56%, 驗證準確率 = 64.20%, 時間 = 53.31s

Epoch 38/100, LR: 0.000794
   批次  15/79: 損失 = 1.6376, 準確率 = 68.85%, 學習率 = 0.000791
   批次  30/79: 損失 = 1.6254, 準確率 = 69.43%, 學習率 = 0.000788
   批次  45/79: 損失 = 1.6346, 準確率 = 68.75%, 學習率 = 0.000786
   批次  60/79: 損失 = 1.6267, 準確率 = 69.48%, 學習率 = 0.000783
   批次  75/79: 損失 = 1.6204, 準確率 = 70.17%, 學習率 = 0.000780
   批次  79/79: 損失 = 1.6171, 準確率 = 70.20%, 學習率 = 0.000780
Epoch 38 完成: 訓練準確率 = 70.20%, 驗證準確率 = 64.00%, 時間 = 58.01s

Epoch 39/100, LR: 0.000780
   批次  15/79: 損失 = 1.5860, 準確率 = 73.54%, 學習率 = 0.000777
   批次  30/79: 損失 = 1.6486, 準確率 = 68.91%, 學習率 = 0.000774
   批次  45/79: 損失 = 1.6384, 準確率 = 69.51%, 學習率 = 0.000771
   批次  60/79: 損失 = 1.6324, 準確率 = 70.03%, 學習率 = 0.000768
   批次  75/79: 損失 = 1.6367, 準確率 = 69.88%, 學習率 = 0.000766
   批次  79/79: 損失 = 1.6376, 準確率 = 70.02%, 學習率 = 0.000765
Epoch 39 完成: 訓練準確率 = 70.02%, 驗證準確率 = 63.10%, 時間 = 55.49s

Epoch 40/100, LR: 0.000765
   批次  15/79: 損失 = 1.6055, 準確率 = 71.67%, 學習率 = 0.000762
   批次  30/79: 損失 = 1.6377, 準確率 = 69.64%, 學習率 = 0.000759
   批次  45/79: 損失 = 1.6246, 準確率 = 70.62%, 學習率 = 0.000756
   批次  60/79: 損失 = 1.6216, 準確率 = 70.81%, 學習率 = 0.000754
   批次  75/79: 損失 = 1.6284, 準確率 = 70.48%, 學習率 = 0.000751
   批次  79/79: 損失 = 1.6304, 準確率 = 70.64%, 學習率 = 0.000750
Epoch 40 完成: 訓練準確率 = 70.64%, 驗證準確率 = 62.20%, 時間 = 61.84s

Epoch 41/100, LR: 0.000750
   批次  15/79: 損失 = 1.5618, 準確率 = 74.90%, 學習率 = 0.000747
   批次  30/79: 損失 = 1.5602, 準確率 = 75.05%, 學習率 = 0.000744
   批次  45/79: 損失 = 1.5802, 準確率 = 73.47%, 學習率 = 0.000741
   批次  60/79: 損失 = 1.5816, 準確率 = 72.92%, 學習率 = 0.000738
   批次  75/79: 損失 = 1.5876, 準確率 = 72.73%, 學習率 = 0.000735
   批次  79/79: 損失 = 1.5891, 準確率 = 72.80%, 學習率 = 0.000735
Epoch 41 完成: 訓練準確率 = 72.80%, 驗證準確率 = 64.40%, 時間 = 61.50s

Epoch 42/100, LR: 0.000735
   批次  15/79: 損失 = 1.5847, 準確率 = 73.54%, 學習率 = 0.000732
   批次  30/79: 損失 = 1.5800, 準確率 = 74.32%, 學習率 = 0.000729
   批次  45/79: 損失 = 1.5770, 準確率 = 74.31%, 學習率 = 0.000726
   批次  60/79: 損失 = 1.5874, 準確率 = 73.28%, 學習率 = 0.000723
   批次  75/79: 損失 = 1.5901, 準確率 = 73.35%, 學習率 = 0.000720
   批次  79/79: 損失 = 1.5937, 準確率 = 73.04%, 學習率 = 0.000719
Epoch 42 完成: 訓練準確率 = 73.04%, 驗證準確率 = 64.20%, 時間 = 53.45s

Epoch 43/100, LR: 0.000719
   批次  15/79: 損失 = 1.5750, 準確率 = 72.40%, 學習率 = 0.000716
   批次  30/79: 損失 = 1.5624, 準確率 = 73.65%, 學習率 = 0.000713
   批次  45/79: 損失 = 1.5792, 準確率 = 72.50%, 學習率 = 0.000710
   批次  60/79: 損失 = 1.5758, 準確率 = 72.92%, 學習率 = 0.000707
   批次  75/79: 損失 = 1.5808, 準確率 = 72.73%, 學習率 = 0.000704
   批次  79/79: 損失 = 1.5797, 準確率 = 72.42%, 學習率 = 0.000703
Epoch 43 完成: 訓練準確率 = 72.42%, 驗證準確率 = 63.10%, 時間 = 48.49s

Epoch 44/100, LR: 0.000703
   批次  15/79: 損失 = 1.5731, 準確率 = 74.38%, 學習率 = 0.000700
   批次  30/79: 損失 = 1.5473, 準確率 = 76.51%, 學習率 = 0.000697
   批次  45/79: 損失 = 1.5583, 準確率 = 74.72%, 學習率 = 0.000694
   批次  60/79: 損失 = 1.5595, 準確率 = 74.87%, 學習率 = 0.000691
   批次  75/79: 損失 = 1.5748, 準確率 = 73.62%, 學習率 = 0.000688
   批次  79/79: 損失 = 1.5747, 準確率 = 73.74%, 學習率 = 0.000687
Epoch 44 完成: 訓練準確率 = 73.74%, 驗證準確率 = 60.00%, 時間 = 53.77s

Epoch 45/100, LR: 0.000687
   批次  15/79: 損失 = 1.5194, 準確率 = 78.12%, 學習率 = 0.000684
   批次  30/79: 損失 = 1.5475, 準確率 = 75.73%, 學習率 = 0.000681
   批次  45/79: 損失 = 1.5726, 準確率 = 73.92%, 學習率 = 0.000678
   批次  60/79: 損失 = 1.5668, 準確率 = 74.24%, 學習率 = 0.000675
   批次  75/79: 損失 = 1.5671, 準確率 = 74.21%, 學習率 = 0.000672
   批次  79/79: 損失 = 1.5703, 準確率 = 74.12%, 學習率 = 0.000671
Epoch 45 完成: 訓練準確率 = 74.12%, 驗證準確率 = 62.40%, 時間 = 51.10s

Epoch 46/100, LR: 0.000671
   批次  15/79: 損失 = 1.4925, 準確率 = 79.17%, 學習率 = 0.000668
   批次  30/79: 損失 = 1.5139, 準確率 = 76.93%, 學習率 = 0.000665
   批次  45/79: 損失 = 1.5245, 準確率 = 77.01%, 學習率 = 0.000662
   批次  60/79: 損失 = 1.5406, 準確率 = 76.07%, 學習率 = 0.000658
   批次  75/79: 損失 = 1.5473, 準確率 = 75.42%, 學習率 = 0.000655
   批次  79/79: 損失 = 1.5435, 準確率 = 75.54%, 學習率 = 0.000654
Epoch 46 完成: 訓練準確率 = 75.54%, 驗證準確率 = 62.20%, 時間 = 51.30s

Epoch 47/100, LR: 0.000654
   批次  15/79: 損失 = 1.4981, 準確率 = 79.79%, 學習率 = 0.000651
   批次  30/79: 損失 = 1.5430, 準確率 = 76.30%, 學習率 = 0.000648
   批次  45/79: 損失 = 1.5528, 準確率 = 75.49%, 學習率 = 0.000645
   批次  60/79: 損失 = 1.5500, 準確率 = 75.62%, 學習率 = 0.000642
   批次  75/79: 損失 = 1.5513, 準確率 = 75.48%, 學習率 = 0.000639
   批次  79/79: 損失 = 1.5495, 準確率 = 75.54%, 學習率 = 0.000638
Epoch 47 完成: 訓練準確率 = 75.54%, 驗證準確率 = 62.80%, 時間 = 54.86s

Epoch 48/100, LR: 0.000638
   批次  15/79: 損失 = 1.5148, 準確率 = 79.06%, 學習率 = 0.000635
   批次  30/79: 損失 = 1.5480, 準確率 = 76.04%, 學習率 = 0.000631
   批次  45/79: 損失 = 1.5411, 準確率 = 76.32%, 學習率 = 0.000628
   批次  60/79: 損失 = 1.5345, 準確率 = 76.77%, 學習率 = 0.000625
   批次  75/79: 損失 = 1.5333, 準確率 = 76.73%, 學習率 = 0.000622
   批次  79/79: 損失 = 1.5336, 準確率 = 76.68%, 學習率 = 0.000621
Epoch 48 完成: 訓練準確率 = 76.68%, 驗證準確率 = 63.10%, 時間 = 52.78s

Epoch 49/100, LR: 0.000621
   批次  15/79: 損失 = 1.5254, 準確率 = 77.71%, 學習率 = 0.000618
   批次  30/79: 損失 = 1.5427, 準確率 = 76.09%, 學習率 = 0.000614
   批次  45/79: 損失 = 1.5391, 準確率 = 76.70%, 學習率 = 0.000611
   批次  60/79: 損失 = 1.5429, 準確率 = 76.51%, 學習率 = 0.000608
   批次  75/79: 損失 = 1.5463, 準確率 = 76.31%, 學習率 = 0.000605
   批次  79/79: 損失 = 1.5484, 準確率 = 76.08%, 學習率 = 0.000604
Epoch 49 完成: 訓練準確率 = 76.08%, 驗證準確率 = 63.70%, 時間 = 51.76s

Epoch 50/100, LR: 0.000604
   批次  15/79: 損失 = 1.4760, 準確率 = 81.35%, 學習率 = 0.000601
   批次  30/79: 損失 = 1.5049, 準確率 = 79.11%, 學習率 = 0.000597
   批次  45/79: 損失 = 1.5123, 準確率 = 78.44%, 學習率 = 0.000594
   批次  60/79: 損失 = 1.5193, 準確率 = 77.92%, 學習率 = 0.000591
   批次  75/79: 損失 = 1.5178, 準確率 = 78.04%, 學習率 = 0.000588
   批次  79/79: 損失 = 1.5226, 準確率 = 77.66%, 學習率 = 0.000587
Epoch 50 完成: 訓練準確率 = 77.66%, 驗證準確率 = 62.70%, 時間 = 48.85s

Epoch 51/100, LR: 0.000587
   批次  15/79: 損失 = 1.4653, 準確率 = 82.19%, 學習率 = 0.000584
   批次  30/79: 損失 = 1.5135, 準確率 = 78.33%, 學習率 = 0.000580
   批次  45/79: 損失 = 1.5228, 準確率 = 77.29%, 學習率 = 0.000577
   批次  60/79: 損失 = 1.5260, 準確率 = 77.21%, 學習率 = 0.000574
   批次  75/79: 損失 = 1.5316, 準確率 = 76.77%, 學習率 = 0.000570
   批次  79/79: 損失 = 1.5329, 準確率 = 76.72%, 學習率 = 0.000570
Epoch 51 完成: 訓練準確率 = 76.72%, 驗證準確率 = 62.30%, 時間 = 50.43s
   🔄 已完成50%訓練，目前最佳驗證準確率: 64.40%

Epoch 52/100, LR: 0.000570
   批次  15/79: 損失 = 1.4473, 準確率 = 83.33%, 學習率 = 0.000566
   批次  30/79: 損失 = 1.4752, 準確率 = 81.25%, 學習率 = 0.000563
   批次  45/79: 損失 = 1.5067, 準確率 = 79.03%, 學習率 = 0.000560
   批次  60/79: 損失 = 1.5062, 準確率 = 78.96%, 學習率 = 0.000556
   批次  75/79: 損失 = 1.5067, 準確率 = 78.92%, 學習率 = 0.000553
   批次  79/79: 損失 = 1.5044, 準確率 = 78.94%, 學習率 = 0.000552
Epoch 52 完成: 訓練準確率 = 78.94%, 驗證準確率 = 63.20%, 時間 = 45.05s
   ⚠️  過擬合警告: 差異 15.74% (連續 1 次)

Epoch 53/100, LR: 0.000552
   批次  15/79: 損失 = 1.4510, 準確率 = 84.27%, 學習率 = 0.000549
   批次  30/79: 損失 = 1.4627, 準確率 = 82.03%, 學習率 = 0.000546
   批次  45/79: 損失 = 1.4845, 準確率 = 80.21%, 學習率 = 0.000542
   批次  60/79: 損失 = 1.4852, 準確率 = 80.08%, 學習率 = 0.000539
   批次  75/79: 損失 = 1.4902, 準確率 = 79.90%, 學習率 = 0.000536
   批次  79/79: 損失 = 1.5002, 準確率 = 79.24%, 學習率 = 0.000535
Epoch 53 完成: 訓練準確率 = 79.24%, 驗證準確率 = 62.40%, 時間 = 49.34s
   ⚠️  過擬合警告: 差異 16.84% (連續 2 次)
   早停：驗證準確率 12 個epoch未提升 (防止過擬合)

⏱️ CPU平衡訓練時間統計:
   • 總訓練時間: 3025.34s (50.42min)
   • 平均每epoch時間: 57.06s
   • 最快epoch時間: 45.05s
   • 最慢epoch時間: 84.19s
   • 最佳驗證準確率: 64.40%
   • 已載入最佳CPU平衡模型權重

📈 繪製CPU訓練歷史...

📊 評估CPU優化模型並生成可視化...
   ✓ CPU模型整體準確率: 64.40%

📋 CPU優化模型詳細分類報告:
              precision    recall  f1-score   support

  0_Airplane      0.627     0.621     0.624       103
1_Automobile      0.672     0.876     0.761        89
      2_Bird      0.541     0.460     0.497       100
       3_Cat      0.600     0.262     0.365       103
      4_Deer      0.477     0.589     0.527        90
       5_Dog      0.487     0.640     0.553        86
      6_Frog      0.696     0.857     0.768       112
     7_Horse      0.684     0.637     0.660       102
      8_Ship      0.811     0.811     0.811       106
     9_Truck      0.831     0.679     0.747       109

    accuracy                          0.644      1000
   macro avg      0.643     0.643     0.631      1000
weighted avg      0.650     0.644     0.635      1000


🔍 可視化CPU模型 12 個樣本預測...

💾 CPU優化模型已保存為 'gmlp_cpu_model.pth'

============================================================
✅ CPU平衡測試完成！

📈 CPU平衡最終結果:
   • 最終測試準確率: 64.40%
   • 最佳驗證準確率: 64.40%
   • 訓練-驗證差異: 16.84%
   • 總訓練時間: 3025.34s (50.42min)
   • 平均每epoch時間: 57.06s

⚖️ CPU平衡特性:
   • 模型參數: 2,016,586
   • 平衡配置: patch_size=4, dim=256, depth=5
   • 數據量: 3000訓練樣本, 600測試樣本
   • 批次大小: 32 (CPU友好)
   • 改進策略: OneCycleLR + 增強數據增強

🎯 超長訓練環境建議:
   • 100 epochs後準確度仍需提升，建議檢查模型架構
   • 考慮增加數據量或調整數據增強策略
   • 檢查是否存在數據品質問題

⚠️  過擬合警告:
   • 訓練-驗證差異過大 (16.84%)
   • 建議增加正則化或減少模型複雜度

🚀 超長訓練總結:
   • 訓練策略: 100 epochs + 多層防過擬合機制
   • 防過擬合技術: 動態數據增強 + 標籤平滑 + 權重衰減 + 早停
   • 學習率調度: OneCycleLR 超長週期優化 + 動態調整
   • 監控機制: 實時過擬合檢測 + 極端情況保護
=======
 CPU平衡版 gMLP 圖像分類測試
============================================================
⚖️ 平衡效率與準確度 - 提升模型性能
============================================================
📦 加載CPU優化的 CIFAR-10 數據集...
   🛡️ CPU防過擬合模式：增加數據量提升泛化能力
   ✓ 訓練樣本: 5000
   ✓ 測試樣本: 1000
   ✓ 類別數: 10
   ✓ CPU防過擬合優化: batch_size=64, 大數據量防過擬合

🏗️ 創建CPU優化的 gMLP 模型...
   ⚡ CPU模式：已設置4個線程
   ✓ CPU平衡模型創建完成
   ✓ 設備: cpu
   ✓ 參數數量: 2,016,586
   ✓ 模型大小: 7.7 MB
   ✓ 準確度優化: patch_size=4, dim=256, depth=5

🏋️ 開始CPU平衡訓練 (100 個 epochs)...

Epoch 1/100, LR: 0.000040
   批次  15/79: 損失 = 2.3011, 準確率 = 11.35%, 學習率 = 0.000041
   批次  30/79: 損失 = 2.2639, 準確率 = 14.90%, 學習率 = 0.000043
   批次  45/79: 損失 = 2.2441, 準確率 = 17.29%, 學習率 = 0.000048
   批次  60/79: 損失 = 2.2325, 準確率 = 18.67%, 學習率 = 0.000054
   批次  75/79: 損失 = 2.2263, 準確率 = 19.06%, 學習率 = 0.000061
   批次  79/79: 損失 = 2.2231, 準確率 = 19.40%, 學習率 = 0.000064
Epoch 1 完成: 訓練準確率 = 19.40%, 驗證準確率 = 18.90%, 時間 = 56.79s

Epoch 2/100, LR: 0.000064
   批次  15/79: 損失 = 2.1943, 準確率 = 20.52%, 學習率 = 0.000073
   批次  30/79: 損失 = 2.1764, 準確率 = 22.81%, 學習率 = 0.000085
   批次  45/79: 損失 = 2.1704, 準確率 = 23.89%, 學習率 = 0.000097
   批次  60/79: 損失 = 2.1668, 準確率 = 24.22%, 學習率 = 0.000112
   批次  75/79: 損失 = 2.1664, 準確率 = 24.23%, 學習率 = 0.000127
   批次  79/79: 損失 = 2.1681, 準確率 = 24.28%, 學習率 = 0.000132
Epoch 2 完成: 訓練準確率 = 24.28%, 驗證準確率 = 26.90%, 時間 = 54.84s

Epoch 3/100, LR: 0.000132
   批次  15/79: 損失 = 2.1314, 準確率 = 27.40%, 學習率 = 0.000149
   批次  30/79: 損失 = 2.1363, 準確率 = 26.82%, 學習率 = 0.000168
   批次  45/79: 損失 = 2.1302, 準確率 = 27.50%, 學習率 = 0.000188
   批次  60/79: 損失 = 2.1294, 準確率 = 27.97%, 學習率 = 0.000210
   批次  75/79: 損失 = 2.1253, 準確率 = 28.60%, 學習率 = 0.000232
   批次  79/79: 損失 = 2.1238, 準確率 = 28.80%, 學習率 = 0.000238
Epoch 3 完成: 訓練準確率 = 28.80%, 驗證準確率 = 29.80%, 時間 = 56.49s

Epoch 4/100, LR: 0.000238
   批次  15/79: 損失 = 2.0898, 準確率 = 32.29%, 學習率 = 0.000262
   批次  30/79: 損失 = 2.0864, 準確率 = 31.72%, 學習率 = 0.000287
   批次  45/79: 損失 = 2.0839, 準確率 = 32.12%, 學習率 = 0.000312
   批次  60/79: 損失 = 2.0837, 準確率 = 31.67%, 學習率 = 0.000338
   批次  75/79: 損失 = 2.0788, 準確率 = 31.94%, 學習率 = 0.000365
   批次  79/79: 損失 = 2.0826, 準確率 = 31.88%, 學習率 = 0.000372
Epoch 4 完成: 訓練準確率 = 31.88%, 驗證準確率 = 36.30%, 時間 = 56.26s

Epoch 5/100, LR: 0.000372
   批次  15/79: 損失 = 2.0551, 準確率 = 34.27%, 學習率 = 0.000400
   批次  30/79: 損失 = 2.0384, 準確率 = 36.35%, 學習率 = 0.000428
   批次  45/79: 損失 = 2.0455, 準確率 = 35.28%, 學習率 = 0.000456
   批次  60/79: 損失 = 2.0430, 準確率 = 35.60%, 學習率 = 0.000485
   批次  75/79: 損失 = 2.0444, 準確率 = 35.65%, 學習率 = 0.000513
   批次  79/79: 損失 = 2.0431, 準確率 = 35.64%, 學習率 = 0.000521
Epoch 5 完成: 訓練準確率 = 35.64%, 驗證準確率 = 35.70%, 時間 = 61.69s

Epoch 6/100, LR: 0.000521
   批次  15/79: 損失 = 2.0458, 準確率 = 35.31%, 學習率 = 0.000550
   批次  30/79: 損失 = 2.0323, 準確率 = 36.46%, 學習率 = 0.000578
   批次  45/79: 損失 = 2.0279, 準確率 = 36.88%, 學習率 = 0.000606
   批次  60/79: 損失 = 2.0255, 準確率 = 37.03%, 學習率 = 0.000635
   批次  75/79: 損失 = 2.0271, 準確率 = 36.75%, 學習率 = 0.000662
   批次  79/79: 損失 = 2.0225, 準確率 = 37.12%, 學習率 = 0.000669
Epoch 6 完成: 訓練準確率 = 37.12%, 驗證準確率 = 38.50%, 時間 = 55.69s

Epoch 7/100, LR: 0.000669
   批次  15/79: 損失 = 2.0072, 準確率 = 38.12%, 學習率 = 0.000696
   批次  30/79: 損失 = 2.0061, 準確率 = 37.66%, 學習率 = 0.000723
   批次  45/79: 損失 = 2.0037, 準確率 = 37.92%, 學習率 = 0.000748
   批次  60/79: 損失 = 2.0018, 準確率 = 38.46%, 學習率 = 0.000773
   批次  75/79: 損失 = 2.0028, 準確率 = 38.50%, 學習率 = 0.000797
   批次  79/79: 損失 = 2.0001, 準確率 = 38.74%, 學習率 = 0.000803
Epoch 7 完成: 訓練準確率 = 38.74%, 驗證準確率 = 46.00%, 時間 = 55.77s

Epoch 8/100, LR: 0.000803
   批次  15/79: 損失 = 1.9585, 準確率 = 42.92%, 學習率 = 0.000826
   批次  30/79: 損失 = 1.9653, 準確率 = 42.71%, 學習率 = 0.000847
   批次  45/79: 損失 = 1.9681, 準確率 = 43.02%, 學習率 = 0.000868
   批次  60/79: 損失 = 1.9703, 準確率 = 42.73%, 學習率 = 0.000887
   批次  75/79: 損失 = 1.9722, 準確率 = 42.35%, 學習率 = 0.000905
   批次  79/79: 損失 = 1.9703, 準確率 = 42.30%, 學習率 = 0.000909
Epoch 8 完成: 訓練準確率 = 42.30%, 驗證準確率 = 47.00%, 時間 = 58.08s

Epoch 9/100, LR: 0.000909
   批次  15/79: 損失 = 1.9458, 準確率 = 42.60%, 學習率 = 0.000925
   批次  30/79: 損失 = 1.9244, 準確率 = 45.42%, 學習率 = 0.000940
   批次  45/79: 損失 = 1.9305, 準確率 = 44.86%, 學習率 = 0.000953
   批次  60/79: 損失 = 1.9316, 準確率 = 45.18%, 學習率 = 0.000965
   批次  75/79: 損失 = 1.9370, 準確率 = 44.75%, 學習率 = 0.000975
   批次  79/79: 損失 = 1.9393, 準確率 = 44.62%, 學習率 = 0.000977
Epoch 9 完成: 訓練準確率 = 44.62%, 驗證準確率 = 48.00%, 時間 = 57.91s

Epoch 10/100, LR: 0.000977
   批次  15/79: 損失 = 1.9327, 準確率 = 45.10%, 學習率 = 0.000985
   批次  30/79: 損失 = 1.9313, 準確率 = 45.83%, 學習率 = 0.000991
   批次  45/79: 損失 = 1.9342, 準確率 = 45.49%, 學習率 = 0.000996
   批次  60/79: 損失 = 1.9304, 準確率 = 45.60%, 學習率 = 0.000999
   批次  75/79: 損失 = 1.9264, 準確率 = 46.27%, 學習率 = 0.001000
   批次  79/79: 損失 = 1.9283, 準確率 = 46.32%, 學習率 = 0.001000
Epoch 10 完成: 訓練準確率 = 46.32%, 驗證準確率 = 49.20%, 時間 = 57.41s

Epoch 11/100, LR: 0.001000
   批次  15/79: 損失 = 1.9007, 準確率 = 48.23%, 學習率 = 0.001000
   批次  30/79: 損失 = 1.8952, 準確率 = 48.59%, 學習率 = 0.001000
   批次  45/79: 損失 = 1.8911, 準確率 = 49.17%, 學習率 = 0.001000
   批次  60/79: 損失 = 1.8941, 準確率 = 48.46%, 學習率 = 0.001000
   批次  75/79: 損失 = 1.9046, 準確率 = 47.65%, 學習率 = 0.001000
   批次  79/79: 損失 = 1.9035, 準確率 = 47.64%, 學習率 = 0.001000
Epoch 11 完成: 訓練準確率 = 47.64%, 驗證準確率 = 51.50%, 時間 = 60.14s
   🔄 已完成10%訓練，目前最佳驗證準確率: 49.20%

Epoch 12/100, LR: 0.001000
   批次  15/79: 損失 = 1.8785, 準確率 = 47.50%, 學習率 = 0.001000
   批次  30/79: 損失 = 1.8697, 準確率 = 49.79%, 學習率 = 0.000999
   批次  45/79: 損失 = 1.8714, 準確率 = 49.44%, 學習率 = 0.000999
   批次  60/79: 損失 = 1.8716, 準確率 = 49.58%, 學習率 = 0.000999
   批次  75/79: 損失 = 1.8790, 準確率 = 49.17%, 學習率 = 0.000999
   批次  79/79: 損失 = 1.8767, 準確率 = 49.56%, 學習率 = 0.000999
Epoch 12 完成: 訓練準確率 = 49.56%, 驗證準確率 = 51.00%, 時間 = 63.59s

Epoch 13/100, LR: 0.000999
   批次  15/79: 損失 = 1.9001, 準確率 = 49.79%, 學習率 = 0.000999
   批次  30/79: 損失 = 1.8897, 準確率 = 50.10%, 學習率 = 0.000998
   批次  45/79: 損失 = 1.8836, 準確率 = 50.03%, 學習率 = 0.000998
   批次  60/79: 損失 = 1.8784, 準確率 = 50.36%, 學習率 = 0.000998
   批次  75/79: 損失 = 1.8764, 準確率 = 50.21%, 學習率 = 0.000997
   批次  79/79: 損失 = 1.8772, 準確率 = 50.30%, 學習率 = 0.000997
Epoch 13 完成: 訓練準確率 = 50.30%, 驗證準確率 = 50.80%, 時間 = 56.14s

Epoch 14/100, LR: 0.000997
   批次  15/79: 損失 = 1.8770, 準確率 = 50.73%, 學習率 = 0.000997
   批次  30/79: 損失 = 1.8651, 準確率 = 50.68%, 學習率 = 0.000996
   批次  45/79: 損失 = 1.8513, 準確率 = 51.84%, 學習率 = 0.000996
   批次  60/79: 損失 = 1.8573, 準確率 = 51.64%, 學習率 = 0.000996
   批次  75/79: 損失 = 1.8532, 準確率 = 52.04%, 學習率 = 0.000995
   批次  79/79: 損失 = 1.8572, 準確率 = 51.52%, 學習率 = 0.000995
Epoch 14 完成: 訓練準確率 = 51.52%, 驗證準確率 = 54.00%, 時間 = 60.10s

Epoch 15/100, LR: 0.000995
   批次  15/79: 損失 = 1.8309, 準確率 = 53.02%, 學習率 = 0.000995
   批次  30/79: 損失 = 1.8247, 準確率 = 53.70%, 學習率 = 0.000994
   批次  45/79: 損失 = 1.8358, 準確率 = 53.26%, 學習率 = 0.000994
   批次  60/79: 損失 = 1.8388, 準確率 = 53.07%, 學習率 = 0.000993
   批次  75/79: 損失 = 1.8342, 準確率 = 53.27%, 學習率 = 0.000993
   批次  79/79: 損失 = 1.8357, 準確率 = 53.30%, 學習率 = 0.000992
Epoch 15 完成: 訓練準確率 = 53.30%, 驗證準確率 = 53.90%, 時間 = 59.78s

Epoch 16/100, LR: 0.000992
   批次  15/79: 損失 = 1.8413, 準確率 = 51.67%, 學習率 = 0.000992
   批次  30/79: 損失 = 1.8339, 準確率 = 53.75%, 學習率 = 0.000991
   批次  45/79: 損失 = 1.8375, 準確率 = 53.75%, 學習率 = 0.000991
   批次  60/79: 損失 = 1.8271, 準確率 = 54.56%, 學習率 = 0.000990
   批次  75/79: 損失 = 1.8214, 準確率 = 55.29%, 學習率 = 0.000989
   批次  79/79: 損失 = 1.8242, 準確率 = 55.18%, 學習率 = 0.000989
Epoch 16 完成: 訓練準確率 = 55.18%, 驗證準確率 = 54.20%, 時間 = 63.26s

Epoch 17/100, LR: 0.000989
   批次  15/79: 損失 = 1.8119, 準確率 = 53.75%, 學習率 = 0.000988
   批次  30/79: 損失 = 1.8056, 準確率 = 55.62%, 學習率 = 0.000988
   批次  45/79: 損失 = 1.8006, 準確率 = 55.97%, 學習率 = 0.000987
   批次  60/79: 損失 = 1.7974, 準確率 = 56.25%, 學習率 = 0.000986
   批次  75/79: 損失 = 1.8021, 準確率 = 55.90%, 學習率 = 0.000985
   批次  79/79: 損失 = 1.8029, 準確率 = 55.70%, 學習率 = 0.000985
Epoch 17 完成: 訓練準確率 = 55.70%, 驗證準確率 = 54.50%, 時間 = 57.06s

Epoch 18/100, LR: 0.000985
   批次  15/79: 損失 = 1.7944, 準確率 = 56.88%, 學習率 = 0.000984
   批次  30/79: 損失 = 1.8069, 準確率 = 55.83%, 學習率 = 0.000983
   批次  45/79: 損失 = 1.8001, 準確率 = 56.32%, 學習率 = 0.000983
   批次  60/79: 損失 = 1.8106, 準確率 = 55.29%, 學習率 = 0.000982
   批次  75/79: 損失 = 1.8063, 準確率 = 55.75%, 學習率 = 0.000981
   批次  79/79: 損失 = 1.8094, 準確率 = 55.74%, 學習率 = 0.000981
Epoch 18 完成: 訓練準確率 = 55.74%, 驗證準確率 = 57.60%, 時間 = 57.85s

Epoch 19/100, LR: 0.000981
   批次  15/79: 損失 = 1.8062, 準確率 = 55.94%, 學習率 = 0.000980
   批次  30/79: 損失 = 1.7999, 準確率 = 57.24%, 學習率 = 0.000979
   批次  45/79: 損失 = 1.7930, 準確率 = 57.88%, 學習率 = 0.000978
   批次  60/79: 損失 = 1.7908, 準確率 = 57.81%, 學習率 = 0.000977
   批次  75/79: 損失 = 1.7892, 準確率 = 57.98%, 學習率 = 0.000976
   批次  79/79: 損失 = 1.7925, 準確率 = 57.74%, 學習率 = 0.000975
Epoch 19 完成: 訓練準確率 = 57.74%, 驗證準確率 = 56.70%, 時間 = 75.49s

Epoch 20/100, LR: 0.000975
   批次  15/79: 損失 = 1.8015, 準確率 = 56.04%, 學習率 = 0.000974
   批次  30/79: 損失 = 1.8126, 準確率 = 53.96%, 學習率 = 0.000973
   批次  45/79: 損失 = 1.8018, 準確率 = 55.14%, 學習率 = 0.000972
   批次  60/79: 損失 = 1.7913, 準確率 = 56.43%, 學習率 = 0.000971
   批次  75/79: 損失 = 1.7923, 準確率 = 56.52%, 學習率 = 0.000970
   批次  79/79: 損失 = 1.7919, 準確率 = 56.50%, 學習率 = 0.000970
Epoch 20 完成: 訓練準確率 = 56.50%, 驗證準確率 = 56.60%, 時間 = 58.78s

Epoch 21/100, LR: 0.000970
   批次  15/79: 損失 = 1.7987, 準確率 = 55.21%, 學習率 = 0.000969
   批次  30/79: 損失 = 1.7988, 準確率 = 56.15%, 學習率 = 0.000967
   批次  45/79: 損失 = 1.7880, 準確率 = 57.19%, 學習率 = 0.000966
   批次  60/79: 損失 = 1.7803, 準確率 = 57.76%, 學習率 = 0.000965
   批次  75/79: 損失 = 1.7829, 準確率 = 57.40%, 學習率 = 0.000964
   批次  79/79: 損失 = 1.7789, 準確率 = 57.70%, 學習率 = 0.000964
Epoch 21 完成: 訓練準確率 = 57.70%, 驗證準確率 = 56.60%, 時間 = 57.97s

Epoch 22/100, LR: 0.000964
   批次  15/79: 損失 = 1.7406, 準確率 = 60.21%, 學習率 = 0.000962
   批次  30/79: 損失 = 1.7545, 準確率 = 58.96%, 學習率 = 0.000961
   批次  45/79: 損失 = 1.7652, 準確率 = 58.72%, 學習率 = 0.000960
   批次  60/79: 損失 = 1.7620, 準確率 = 58.67%, 學習率 = 0.000958
   批次  75/79: 損失 = 1.7674, 準確率 = 58.19%, 學習率 = 0.000957
   批次  79/79: 損失 = 1.7664, 準確率 = 58.38%, 學習率 = 0.000957
Epoch 22 完成: 訓練準確率 = 58.38%, 驗證準確率 = 57.60%, 時間 = 58.89s

Epoch 23/100, LR: 0.000957
   批次  15/79: 損失 = 1.7769, 準確率 = 57.60%, 學習率 = 0.000955
   批次  30/79: 損失 = 1.7519, 準確率 = 60.26%, 學習率 = 0.000954
   批次  45/79: 損失 = 1.7461, 準確率 = 59.83%, 學習率 = 0.000953
   批次  60/79: 損失 = 1.7519, 準確率 = 59.22%, 學習率 = 0.000951
   批次  75/79: 損失 = 1.7479, 準確率 = 59.54%, 學習率 = 0.000950
   批次  79/79: 損失 = 1.7462, 準確率 = 59.80%, 學習率 = 0.000949
Epoch 23 完成: 訓練準確率 = 59.80%, 驗證準確率 = 57.90%, 時間 = 62.84s

Epoch 24/100, LR: 0.000949
   批次  15/79: 損失 = 1.7380, 準確率 = 61.25%, 學習率 = 0.000948
   批次  30/79: 損失 = 1.7337, 準確率 = 61.56%, 學習率 = 0.000946
   批次  45/79: 損失 = 1.7390, 準確率 = 60.83%, 學習率 = 0.000945
   批次  60/79: 損失 = 1.7429, 準確率 = 61.12%, 學習率 = 0.000943
   批次  75/79: 損失 = 1.7339, 準確率 = 61.96%, 學習率 = 0.000942
   批次  79/79: 損失 = 1.7378, 準確率 = 61.64%, 學習率 = 0.000941
Epoch 24 完成: 訓練準確率 = 61.64%, 驗證準確率 = 58.10%, 時間 = 56.69s

Epoch 25/100, LR: 0.000941
   批次  15/79: 損失 = 1.7552, 準確率 = 59.90%, 學習率 = 0.000940
   批次  30/79: 損失 = 1.7293, 準確率 = 61.77%, 學習率 = 0.000938
   批次  45/79: 損失 = 1.7420, 準確率 = 61.01%, 學習率 = 0.000937
   批次  60/79: 損失 = 1.7450, 準確率 = 60.94%, 學習率 = 0.000935
   批次  75/79: 損失 = 1.7450, 準確率 = 60.79%, 學習率 = 0.000933
   批次  79/79: 損失 = 1.7476, 準確率 = 60.86%, 學習率 = 0.000933
Epoch 25 完成: 訓練準確率 = 60.86%, 驗證準確率 = 58.70%, 時間 = 56.24s

Epoch 26/100, LR: 0.000933
   批次  15/79: 損失 = 1.6688, 準確率 = 64.69%, 學習率 = 0.000931
   批次  30/79: 損失 = 1.7027, 準確率 = 62.76%, 學習率 = 0.000930
   批次  45/79: 損失 = 1.7194, 準確率 = 62.36%, 學習率 = 0.000928
   批次  60/79: 損失 = 1.7133, 準確率 = 62.92%, 學習率 = 0.000926
   批次  75/79: 損失 = 1.7174, 準確率 = 62.73%, 學習率 = 0.000924
   批次  75/79: 損失 = 1.7174, 準確率 = 62.73%, 學習率 = 0.000924
   批次  79/79: 損失 = 1.7224, 準確率 = 62.62%, 學習率 = 0.000924
Epoch 26 完成: 訓練準確率 = 62.62%, 驗證準確率 = 60.30%, 時間 = 63.26s
   🔄 已完成25%訓練，目前最佳驗證準確率: 58.70%

Epoch 27/100, LR: 0.000924
   批次  15/79: 損失 = 1.6887, 準確率 = 64.69%, 學習率 = 0.000922
   批次  30/79: 損失 = 1.7058, 準確率 = 63.49%, 學習率 = 0.000920
   批次  45/79: 損失 = 1.7079, 準確率 = 62.95%, 學習率 = 0.000919
   批次  60/79: 損失 = 1.7116, 準確率 = 62.79%, 學習率 = 0.000917
   批次  75/79: 損失 = 1.7159, 準確率 = 62.90%, 學習率 = 0.000915
   批次  79/79: 損失 = 1.7192, 準確率 = 62.68%, 學習率 = 0.000914
Epoch 27 完成: 訓練準確率 = 62.68%, 驗證準確率 = 60.10%, 時間 = 84.19s

Epoch 28/100, LR: 0.000914
   批次  15/79: 損失 = 1.6910, 準確率 = 64.27%, 學習率 = 0.000913
   批次  30/79: 損失 = 1.7137, 準確率 = 62.14%, 學習率 = 0.000911
   批次  45/79: 損失 = 1.7096, 準確率 = 62.88%, 學習率 = 0.000909
   批次  60/79: 損失 = 1.7060, 準確率 = 63.44%, 學習率 = 0.000907
   批次  75/79: 損失 = 1.7094, 準確率 = 63.50%, 學習率 = 0.000905
   批次  79/79: 損失 = 1.7091, 準確率 = 63.28%, 學習率 = 0.000904
Epoch 28 完成: 訓練準確率 = 63.28%, 驗證準確率 = 61.30%, 時間 = 63.13s

Epoch 29/100, LR: 0.000904
   批次  15/79: 損失 = 1.7042, 準確率 = 64.27%, 學習率 = 0.000902
   批次  30/79: 損失 = 1.6939, 準確率 = 65.00%, 學習率 = 0.000900
   批次  45/79: 損失 = 1.6824, 準確率 = 65.66%, 學習率 = 0.000898
   批次  60/79: 損失 = 1.6795, 準確率 = 65.99%, 學習率 = 0.000896
   批次  75/79: 損失 = 1.6880, 準確率 = 65.38%, 學習率 = 0.000894
   批次  79/79: 損失 = 1.6858, 準確率 = 65.24%, 學習率 = 0.000894
Epoch 29 完成: 訓練準確率 = 65.24%, 驗證準確率 = 61.00%, 時間 = 52.48s

Epoch 30/100, LR: 0.000894
   批次  15/79: 損失 = 1.7105, 準確率 = 62.92%, 學習率 = 0.000892
   批次  30/79: 損失 = 1.7049, 準確率 = 63.07%, 學習率 = 0.000890
   批次  45/79: 損失 = 1.7133, 準確率 = 62.92%, 學習率 = 0.000888
   批次  60/79: 損失 = 1.7054, 準確率 = 63.75%, 學習率 = 0.000886
   批次  75/79: 損失 = 1.7018, 準確率 = 63.94%, 學習率 = 0.000883
   批次  79/79: 損失 = 1.6950, 準確率 = 64.24%, 學習率 = 0.000883
Epoch 30 完成: 訓練準確率 = 64.24%, 驗證準確率 = 60.10%, 時間 = 55.56s

Epoch 31/100, LR: 0.000883
   批次  15/79: 損失 = 1.6777, 準確率 = 66.46%, 學習率 = 0.000881
   批次  30/79: 損失 = 1.6824, 準確率 = 65.00%, 學習率 = 0.000879
   批次  45/79: 損失 = 1.6809, 準確率 = 65.52%, 學習率 = 0.000876
   批次  60/79: 損失 = 1.6791, 準確率 = 65.81%, 學習率 = 0.000874
   批次  75/79: 損失 = 1.6838, 準確率 = 65.62%, 學習率 = 0.000872
   批次  79/79: 損失 = 1.6845, 準確率 = 65.46%, 學習率 = 0.000871
Epoch 31 完成: 訓練準確率 = 65.46%, 驗證準確率 = 61.50%, 時間 = 51.34s

Epoch 32/100, LR: 0.000871
   批次  15/79: 損失 = 1.6289, 準確率 = 68.44%, 學習率 = 0.000869
   批次  30/79: 損失 = 1.6527, 準確率 = 67.76%, 學習率 = 0.000867
   批次  45/79: 損失 = 1.6510, 準確率 = 68.02%, 學習率 = 0.000865
   批次  60/79: 損失 = 1.6604, 準確率 = 67.19%, 學習率 = 0.000862
   批次  75/79: 損失 = 1.6732, 準確率 = 66.79%, 學習率 = 0.000860
   批次  79/79: 損失 = 1.6733, 準確率 = 66.84%, 學習率 = 0.000860
Epoch 32 完成: 訓練準確率 = 66.84%, 驗證準確率 = 64.20%, 時間 = 53.13s

Epoch 33/100, LR: 0.000860
   批次  15/79: 損失 = 1.6394, 準確率 = 69.48%, 學習率 = 0.000857
   批次  30/79: 損失 = 1.6591, 準確率 = 66.72%, 學習率 = 0.000855
   批次  45/79: 損失 = 1.6562, 準確率 = 67.43%, 學習率 = 0.000853
   批次  60/79: 損失 = 1.6523, 準確率 = 67.63%, 學習率 = 0.000850
   批次  75/79: 損失 = 1.6564, 準確率 = 67.19%, 學習率 = 0.000848
   批次  79/79: 損失 = 1.6565, 準確率 = 67.10%, 學習率 = 0.000847
Epoch 33 完成: 訓練準確率 = 67.10%, 驗證準確率 = 61.20%, 時間 = 58.29s

Epoch 34/100, LR: 0.000847
   批次  15/79: 損失 = 1.6151, 準確率 = 70.10%, 學習率 = 0.000845
   批次  30/79: 損失 = 1.6230, 準確率 = 69.64%, 學習率 = 0.000842
   批次  45/79: 損失 = 1.6242, 準確率 = 70.24%, 學習率 = 0.000840
   批次  60/79: 損失 = 1.6295, 準確率 = 69.61%, 學習率 = 0.000838
   批次  75/79: 損失 = 1.6408, 準確率 = 68.96%, 學習率 = 0.000835
   批次  79/79: 損失 = 1.6449, 準確率 = 68.72%, 學習率 = 0.000834
Epoch 34 完成: 訓練準確率 = 68.72%, 驗證準確率 = 61.10%, 時間 = 51.39s

Epoch 35/100, LR: 0.000834
   批次  15/79: 損失 = 1.6032, 準確率 = 72.19%, 學習率 = 0.000832
   批次  30/79: 損失 = 1.6139, 準確率 = 70.89%, 學習率 = 0.000830
   批次  45/79: 損失 = 1.6288, 準確率 = 69.76%, 學習率 = 0.000827
   批次  60/79: 損失 = 1.6315, 準確率 = 69.43%, 學習率 = 0.000825
   批次  75/79: 損失 = 1.6370, 準確率 = 68.94%, 學習率 = 0.000822
   批次  79/79: 損失 = 1.6352, 準確率 = 68.96%, 學習率 = 0.000821
Epoch 35 完成: 訓練準確率 = 68.96%, 驗證準確率 = 61.90%, 時間 = 54.53s

Epoch 36/100, LR: 0.000821
   批次  15/79: 損失 = 1.6075, 準確率 = 72.40%, 學習率 = 0.000819
   批次  30/79: 損失 = 1.6346, 準確率 = 69.06%, 學習率 = 0.000816
   批次  45/79: 損失 = 1.6260, 準確率 = 69.65%, 學習率 = 0.000814
   批次  60/79: 損失 = 1.6264, 準確率 = 69.64%, 學習率 = 0.000811
   批次  75/79: 損失 = 1.6332, 準確率 = 69.06%, 學習率 = 0.000808
   批次  79/79: 損失 = 1.6366, 準確率 = 68.64%, 學習率 = 0.000808
Epoch 36 完成: 訓練準確率 = 68.64%, 驗證準確率 = 60.40%, 時間 = 59.81s

Epoch 37/100, LR: 0.000808
   批次  15/79: 損失 = 1.5863, 準確率 = 73.12%, 學習率 = 0.000805
   批次  30/79: 損失 = 1.5945, 準確率 = 72.29%, 學習率 = 0.000802
   批次  45/79: 損失 = 1.6165, 準確率 = 70.49%, 學習率 = 0.000800
   批次  60/79: 損失 = 1.6211, 準確率 = 69.90%, 學習率 = 0.000797
   批次  75/79: 損失 = 1.6235, 準確率 = 69.65%, 學習率 = 0.000795
   批次  79/79: 損失 = 1.6233, 準確率 = 69.56%, 學習率 = 0.000794
Epoch 37 完成: 訓練準確率 = 69.56%, 驗證準確率 = 64.20%, 時間 = 53.31s

Epoch 38/100, LR: 0.000794
   批次  15/79: 損失 = 1.6376, 準確率 = 68.85%, 學習率 = 0.000791
   批次  30/79: 損失 = 1.6254, 準確率 = 69.43%, 學習率 = 0.000788
   批次  45/79: 損失 = 1.6346, 準確率 = 68.75%, 學習率 = 0.000786
   批次  60/79: 損失 = 1.6267, 準確率 = 69.48%, 學習率 = 0.000783
   批次  75/79: 損失 = 1.6204, 準確率 = 70.17%, 學習率 = 0.000780
   批次  79/79: 損失 = 1.6171, 準確率 = 70.20%, 學習率 = 0.000780
Epoch 38 完成: 訓練準確率 = 70.20%, 驗證準確率 = 64.00%, 時間 = 58.01s

Epoch 39/100, LR: 0.000780
   批次  15/79: 損失 = 1.5860, 準確率 = 73.54%, 學習率 = 0.000777
   批次  30/79: 損失 = 1.6486, 準確率 = 68.91%, 學習率 = 0.000774
   批次  45/79: 損失 = 1.6384, 準確率 = 69.51%, 學習率 = 0.000771
   批次  60/79: 損失 = 1.6324, 準確率 = 70.03%, 學習率 = 0.000768
   批次  75/79: 損失 = 1.6367, 準確率 = 69.88%, 學習率 = 0.000766
   批次  79/79: 損失 = 1.6376, 準確率 = 70.02%, 學習率 = 0.000765
Epoch 39 完成: 訓練準確率 = 70.02%, 驗證準確率 = 63.10%, 時間 = 55.49s

Epoch 40/100, LR: 0.000765
   批次  15/79: 損失 = 1.6055, 準確率 = 71.67%, 學習率 = 0.000762
   批次  30/79: 損失 = 1.6377, 準確率 = 69.64%, 學習率 = 0.000759
   批次  45/79: 損失 = 1.6246, 準確率 = 70.62%, 學習率 = 0.000756
   批次  60/79: 損失 = 1.6216, 準確率 = 70.81%, 學習率 = 0.000754
   批次  75/79: 損失 = 1.6284, 準確率 = 70.48%, 學習率 = 0.000751
   批次  79/79: 損失 = 1.6304, 準確率 = 70.64%, 學習率 = 0.000750
Epoch 40 完成: 訓練準確率 = 70.64%, 驗證準確率 = 62.20%, 時間 = 61.84s

Epoch 41/100, LR: 0.000750
   批次  15/79: 損失 = 1.5618, 準確率 = 74.90%, 學習率 = 0.000747
   批次  30/79: 損失 = 1.5602, 準確率 = 75.05%, 學習率 = 0.000744
   批次  45/79: 損失 = 1.5802, 準確率 = 73.47%, 學習率 = 0.000741
   批次  60/79: 損失 = 1.5816, 準確率 = 72.92%, 學習率 = 0.000738
   批次  75/79: 損失 = 1.5876, 準確率 = 72.73%, 學習率 = 0.000735
   批次  79/79: 損失 = 1.5891, 準確率 = 72.80%, 學習率 = 0.000735
Epoch 41 完成: 訓練準確率 = 72.80%, 驗證準確率 = 64.40%, 時間 = 61.50s

Epoch 42/100, LR: 0.000735
   批次  15/79: 損失 = 1.5847, 準確率 = 73.54%, 學習率 = 0.000732
   批次  30/79: 損失 = 1.5800, 準確率 = 74.32%, 學習率 = 0.000729
   批次  45/79: 損失 = 1.5770, 準確率 = 74.31%, 學習率 = 0.000726
   批次  60/79: 損失 = 1.5874, 準確率 = 73.28%, 學習率 = 0.000723
   批次  75/79: 損失 = 1.5901, 準確率 = 73.35%, 學習率 = 0.000720
   批次  79/79: 損失 = 1.5937, 準確率 = 73.04%, 學習率 = 0.000719
Epoch 42 完成: 訓練準確率 = 73.04%, 驗證準確率 = 64.20%, 時間 = 53.45s

Epoch 43/100, LR: 0.000719
   批次  15/79: 損失 = 1.5750, 準確率 = 72.40%, 學習率 = 0.000716
   批次  30/79: 損失 = 1.5624, 準確率 = 73.65%, 學習率 = 0.000713
   批次  45/79: 損失 = 1.5792, 準確率 = 72.50%, 學習率 = 0.000710
   批次  60/79: 損失 = 1.5758, 準確率 = 72.92%, 學習率 = 0.000707
   批次  75/79: 損失 = 1.5808, 準確率 = 72.73%, 學習率 = 0.000704
   批次  79/79: 損失 = 1.5797, 準確率 = 72.42%, 學習率 = 0.000703
Epoch 43 完成: 訓練準確率 = 72.42%, 驗證準確率 = 63.10%, 時間 = 48.49s

Epoch 44/100, LR: 0.000703
   批次  15/79: 損失 = 1.5731, 準確率 = 74.38%, 學習率 = 0.000700
   批次  30/79: 損失 = 1.5473, 準確率 = 76.51%, 學習率 = 0.000697
   批次  45/79: 損失 = 1.5583, 準確率 = 74.72%, 學習率 = 0.000694
   批次  60/79: 損失 = 1.5595, 準確率 = 74.87%, 學習率 = 0.000691
   批次  75/79: 損失 = 1.5748, 準確率 = 73.62%, 學習率 = 0.000688
   批次  79/79: 損失 = 1.5747, 準確率 = 73.74%, 學習率 = 0.000687
Epoch 44 完成: 訓練準確率 = 73.74%, 驗證準確率 = 60.00%, 時間 = 53.77s

Epoch 45/100, LR: 0.000687
   批次  15/79: 損失 = 1.5194, 準確率 = 78.12%, 學習率 = 0.000684
   批次  30/79: 損失 = 1.5475, 準確率 = 75.73%, 學習率 = 0.000681
   批次  45/79: 損失 = 1.5726, 準確率 = 73.92%, 學習率 = 0.000678
   批次  60/79: 損失 = 1.5668, 準確率 = 74.24%, 學習率 = 0.000675
   批次  75/79: 損失 = 1.5671, 準確率 = 74.21%, 學習率 = 0.000672
   批次  79/79: 損失 = 1.5703, 準確率 = 74.12%, 學習率 = 0.000671
Epoch 45 完成: 訓練準確率 = 74.12%, 驗證準確率 = 62.40%, 時間 = 51.10s

Epoch 46/100, LR: 0.000671
   批次  15/79: 損失 = 1.4925, 準確率 = 79.17%, 學習率 = 0.000668
   批次  30/79: 損失 = 1.5139, 準確率 = 76.93%, 學習率 = 0.000665
   批次  45/79: 損失 = 1.5245, 準確率 = 77.01%, 學習率 = 0.000662
   批次  60/79: 損失 = 1.5406, 準確率 = 76.07%, 學習率 = 0.000658
   批次  75/79: 損失 = 1.5473, 準確率 = 75.42%, 學習率 = 0.000655
   批次  79/79: 損失 = 1.5435, 準確率 = 75.54%, 學習率 = 0.000654
Epoch 46 完成: 訓練準確率 = 75.54%, 驗證準確率 = 62.20%, 時間 = 51.30s

Epoch 47/100, LR: 0.000654
   批次  15/79: 損失 = 1.4981, 準確率 = 79.79%, 學習率 = 0.000651
   批次  30/79: 損失 = 1.5430, 準確率 = 76.30%, 學習率 = 0.000648
   批次  45/79: 損失 = 1.5528, 準確率 = 75.49%, 學習率 = 0.000645
   批次  60/79: 損失 = 1.5500, 準確率 = 75.62%, 學習率 = 0.000642
   批次  75/79: 損失 = 1.5513, 準確率 = 75.48%, 學習率 = 0.000639
   批次  79/79: 損失 = 1.5495, 準確率 = 75.54%, 學習率 = 0.000638
Epoch 47 完成: 訓練準確率 = 75.54%, 驗證準確率 = 62.80%, 時間 = 54.86s

Epoch 48/100, LR: 0.000638
   批次  15/79: 損失 = 1.5148, 準確率 = 79.06%, 學習率 = 0.000635
   批次  30/79: 損失 = 1.5480, 準確率 = 76.04%, 學習率 = 0.000631
   批次  45/79: 損失 = 1.5411, 準確率 = 76.32%, 學習率 = 0.000628
   批次  60/79: 損失 = 1.5345, 準確率 = 76.77%, 學習率 = 0.000625
   批次  75/79: 損失 = 1.5333, 準確率 = 76.73%, 學習率 = 0.000622
   批次  79/79: 損失 = 1.5336, 準確率 = 76.68%, 學習率 = 0.000621
Epoch 48 完成: 訓練準確率 = 76.68%, 驗證準確率 = 63.10%, 時間 = 52.78s

Epoch 49/100, LR: 0.000621
   批次  15/79: 損失 = 1.5254, 準確率 = 77.71%, 學習率 = 0.000618
   批次  30/79: 損失 = 1.5427, 準確率 = 76.09%, 學習率 = 0.000614
   批次  45/79: 損失 = 1.5391, 準確率 = 76.70%, 學習率 = 0.000611
   批次  60/79: 損失 = 1.5429, 準確率 = 76.51%, 學習率 = 0.000608
   批次  75/79: 損失 = 1.5463, 準確率 = 76.31%, 學習率 = 0.000605
   批次  79/79: 損失 = 1.5484, 準確率 = 76.08%, 學習率 = 0.000604
Epoch 49 完成: 訓練準確率 = 76.08%, 驗證準確率 = 63.70%, 時間 = 51.76s

Epoch 50/100, LR: 0.000604
   批次  15/79: 損失 = 1.4760, 準確率 = 81.35%, 學習率 = 0.000601
   批次  30/79: 損失 = 1.5049, 準確率 = 79.11%, 學習率 = 0.000597
   批次  45/79: 損失 = 1.5123, 準確率 = 78.44%, 學習率 = 0.000594
   批次  60/79: 損失 = 1.5193, 準確率 = 77.92%, 學習率 = 0.000591
   批次  75/79: 損失 = 1.5178, 準確率 = 78.04%, 學習率 = 0.000588
   批次  79/79: 損失 = 1.5226, 準確率 = 77.66%, 學習率 = 0.000587
Epoch 50 完成: 訓練準確率 = 77.66%, 驗證準確率 = 62.70%, 時間 = 48.85s

Epoch 51/100, LR: 0.000587
   批次  15/79: 損失 = 1.4653, 準確率 = 82.19%, 學習率 = 0.000584
   批次  30/79: 損失 = 1.5135, 準確率 = 78.33%, 學習率 = 0.000580
   批次  45/79: 損失 = 1.5228, 準確率 = 77.29%, 學習率 = 0.000577
   批次  60/79: 損失 = 1.5260, 準確率 = 77.21%, 學習率 = 0.000574
   批次  75/79: 損失 = 1.5316, 準確率 = 76.77%, 學習率 = 0.000570
   批次  79/79: 損失 = 1.5329, 準確率 = 76.72%, 學習率 = 0.000570
Epoch 51 完成: 訓練準確率 = 76.72%, 驗證準確率 = 62.30%, 時間 = 50.43s
   🔄 已完成50%訓練，目前最佳驗證準確率: 64.40%

Epoch 52/100, LR: 0.000570
   批次  15/79: 損失 = 1.4473, 準確率 = 83.33%, 學習率 = 0.000566
   批次  30/79: 損失 = 1.4752, 準確率 = 81.25%, 學習率 = 0.000563
   批次  45/79: 損失 = 1.5067, 準確率 = 79.03%, 學習率 = 0.000560
   批次  60/79: 損失 = 1.5062, 準確率 = 78.96%, 學習率 = 0.000556
   批次  75/79: 損失 = 1.5067, 準確率 = 78.92%, 學習率 = 0.000553
   批次  79/79: 損失 = 1.5044, 準確率 = 78.94%, 學習率 = 0.000552
Epoch 52 完成: 訓練準確率 = 78.94%, 驗證準確率 = 63.20%, 時間 = 45.05s
   ⚠️  過擬合警告: 差異 15.74% (連續 1 次)

Epoch 53/100, LR: 0.000552
   批次  15/79: 損失 = 1.4510, 準確率 = 84.27%, 學習率 = 0.000549
   批次  30/79: 損失 = 1.4627, 準確率 = 82.03%, 學習率 = 0.000546
   批次  45/79: 損失 = 1.4845, 準確率 = 80.21%, 學習率 = 0.000542
   批次  60/79: 損失 = 1.4852, 準確率 = 80.08%, 學習率 = 0.000539
   批次  75/79: 損失 = 1.4902, 準確率 = 79.90%, 學習率 = 0.000536
   批次  79/79: 損失 = 1.5002, 準確率 = 79.24%, 學習率 = 0.000535
Epoch 53 完成: 訓練準確率 = 79.24%, 驗證準確率 = 62.40%, 時間 = 49.34s
   ⚠️  過擬合警告: 差異 16.84% (連續 2 次)
   早停：驗證準確率 12 個epoch未提升 (防止過擬合)

⏱️ CPU平衡訓練時間統計:
   • 總訓練時間: 3025.34s (50.42min)
   • 平均每epoch時間: 57.06s
   • 最快epoch時間: 45.05s
   • 最慢epoch時間: 84.19s
   • 最佳驗證準確率: 64.40%
   • 已載入最佳CPU平衡模型權重

📈 繪製CPU訓練歷史...

📊 評估CPU優化模型並生成可視化...
   ✓ CPU模型整體準確率: 64.40%

📋 CPU優化模型詳細分類報告:
              precision    recall  f1-score   support

  0_Airplane      0.627     0.621     0.624       103
1_Automobile      0.672     0.876     0.761        89
      2_Bird      0.541     0.460     0.497       100
       3_Cat      0.600     0.262     0.365       103
      4_Deer      0.477     0.589     0.527        90
       5_Dog      0.487     0.640     0.553        86
      6_Frog      0.696     0.857     0.768       112
     7_Horse      0.684     0.637     0.660       102
      8_Ship      0.811     0.811     0.811       106
     9_Truck      0.831     0.679     0.747       109

    accuracy                          0.644      1000
   macro avg      0.643     0.643     0.631      1000
weighted avg      0.650     0.644     0.635      1000


🔍 可視化CPU模型 12 個樣本預測...

💾 CPU優化模型已保存為 'gmlp_cpu_model.pth'

============================================================
✅ CPU平衡測試完成！

📈 CPU平衡最終結果:
   • 最終測試準確率: 64.40%
   • 最佳驗證準確率: 64.40%
   • 訓練-驗證差異: 16.84%
   • 總訓練時間: 3025.34s (50.42min)
   • 平均每epoch時間: 57.06s

⚖️ CPU平衡特性:
   • 模型參數: 2,016,586
   • 平衡配置: patch_size=4, dim=256, depth=5
   • 數據量: 3000訓練樣本, 600測試樣本
   • 批次大小: 32 (CPU友好)
   • 改進策略: OneCycleLR + 增強數據增強

🎯 超長訓練環境建議:
   • 100 epochs後準確度仍需提升，建議檢查模型架構
   • 考慮增加數據量或調整數據增強策略
   • 檢查是否存在數據品質問題

⚠️  過擬合警告:
   • 訓練-驗證差異過大 (16.84%)
   • 建議增加正則化或減少模型複雜度

🚀 超長訓練總結:
   • 訓練策略: 100 epochs + 多層防過擬合機制
   • 防過擬合技術: 動態數據增強 + 標籤平滑 + 權重衰減 + 早停
   • 學習率調度: OneCycleLR 超長週期優化 + 動態調整
   • 監控機制: 實時過擬合檢測 + 極端情況保護
>>>>>>> 420764095488647da1ecd1309c810893dfec8ea4
   • 準確度導向: 在防過擬合前提下最大化準確度