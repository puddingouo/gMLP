🚀 超縮小版 gMLP 圖像分類訓練開始
============================================================

📋 超縮小版 gMLP 模型架構比較:
======================================================================
模型       深度     維度       FFN倍數    參數(M)     
----------------------------------------------------------------------
Nano     6      64       2        0.3       
XS       8      80       3        0.8       
S        12     128      3        2.0       
M        16     160      4        4.5       
----------------------------------------------------------------------
🎯 建議:
   • Nano: 極速原型開發 (<1分鐘訓練)
   • XS: 快速實驗 (~2分鐘訓練)
   • S: 平衡性能與速度 (~5分鐘訓練)
   • M: 較好性能但稍慢 (~10分鐘訓練)
📦 加載超快速 CIFAR-10 數據集...
   🚀 超快速模式：小規模數據集訓練
   ✓ 訓練樣本: 10000
   ✓ 測試樣本: 2000
   ✓ Batch大小: 64

🏗️ 創建超縮小版 gMLP-L 模型...
   ⚡ CPU模式：已設置4個線程
   ✓ 超縮小版 gMLP-L 模型創建完成
   ✓ 設備: cpu
   ✓ 參數數量: 4,613,898 (4.61M)
   ✓ 目標參數: 5.9M
   ✓ 模型大小: 17.6 MB
   ✓ 架構: depth=30, dim=128, ff_mult=6

🏋️ 開始超快速訓練 (50 個 epochs)...
   🛡️  啟用過擬合早停保護

Epoch 1/50, LR: 0.003000
   批次 20/157: 損失=2.2816, 準確率=16.56%
   批次 40/157: 損失=2.2179, 準確率=18.20%
   批次 60/157: 損失=2.1672, 準確率=20.26%
   批次 80/157: 損失=2.1350, 準確率=21.74%
   批次 100/157: 損失=2.1119, 準確率=22.58%
   批次 120/157: 損失=2.0984, 準確率=23.09%
   批次 140/157: 損失=2.0846, 準確率=23.88%
Epoch 1 完成: 訓練=24.14%, 驗證=32.15%, 時間=317.2s
   💾 新最佳模型已保存: 驗證準確率 32.15%

Epoch 2/50, LR: 0.002997
   批次 20/157: 損失=1.9481, 準確率=28.75%
   批次 40/157: 損失=1.9363, 準確率=29.84%
   批次 60/157: 損失=1.9343, 準確率=30.08%
   批次 80/157: 損失=1.9336, 準確率=30.14%
   批次 100/157: 損失=1.9270, 準確率=30.44%
   批次 120/157: 損失=1.9197, 準確率=30.65%
   批次 140/157: 損失=1.9226, 準確率=30.57%
Epoch 2 完成: 訓練=31.08%, 驗證=34.30%, 時間=313.1s
   💾 新最佳模型已保存: 驗證準確率 34.30%

Epoch 3/50, LR: 0.002988
   批次 20/157: 損失=1.8864, 準確率=33.05%
   批次 40/157: 損失=1.8661, 準確率=33.79%
   批次 60/157: 損失=1.8433, 準確率=34.45%
   批次 80/157: 損失=1.8338, 準確率=35.12%
   批次 100/157: 損失=1.8358, 準確率=34.84%
   批次 120/157: 損失=1.8382, 準確率=34.80%
   批次 140/157: 損失=1.8336, 準確率=35.16%
Epoch 3 完成: 訓練=35.26%, 驗證=38.15%, 時間=314.0s
   💾 新最佳模型已保存: 驗證準確率 38.15%

Epoch 4/50, LR: 0.002974
   批次 20/157: 損失=1.7742, 準確率=37.97%
   批次 40/157: 損失=1.7683, 準確率=38.91%
   批次 60/157: 損失=1.7738, 準確率=38.36%
   批次 80/157: 損失=1.7719, 準確率=38.79%
   批次 100/157: 損失=1.7737, 準確率=38.86%
   批次 120/157: 損失=1.7654, 準確率=39.27%
   批次 140/157: 損失=1.7596, 準確率=39.67%
Epoch 4 完成: 訓練=39.64%, 驗證=42.30%, 時間=322.8s
   💾 新最佳模型已保存: 驗證準確率 42.30%

Epoch 5/50, LR: 0.002953
   批次 20/157: 損失=1.6734, 準確率=42.58%
   批次 40/157: 損失=1.6954, 準確率=41.45%
   批次 60/157: 損失=1.6892, 準確率=41.46%
   批次 80/157: 損失=1.6836, 準確率=41.88%
   批次 100/157: 損失=1.6925, 準確率=41.80%
   批次 120/157: 損失=1.6882, 準確率=42.03%
   批次 140/157: 損失=1.6853, 準確率=42.20%
Epoch 5 完成: 訓練=42.34%, 驗證=44.00%, 時間=319.7s
   💾 新最佳模型已保存: 驗證準確率 44.00%

Epoch 6/50, LR: 0.002927
   批次 20/157: 損失=1.6274, 準確率=44.45%
   批次 40/157: 損失=1.6124, 準確率=45.43%
   批次 60/157: 損失=1.6214, 準確率=44.45%
   批次 80/157: 損失=1.6269, 準確率=44.06%
   批次 100/157: 損失=1.6198, 準確率=44.44%
   批次 120/157: 損失=1.6193, 準確率=44.52%
   批次 140/157: 損失=1.6156, 準確率=44.62%
Epoch 6 完成: 訓練=44.62%, 驗證=46.65%, 時間=321.9s
   💾 新最佳模型已保存: 驗證準確率 46.65%

Epoch 7/50, LR: 0.002895
   批次 20/157: 損失=1.6225, 準確率=45.70%
   批次 40/157: 損失=1.5826, 準確率=47.15%
   批次 60/157: 損失=1.5689, 準確率=47.06%
   批次 80/157: 損失=1.5685, 準確率=46.78%
   批次 100/157: 損失=1.5725, 準確率=46.91%
   批次 120/157: 損失=1.5678, 準確率=47.15%
   批次 140/157: 損失=1.5655, 準確率=46.91%
Epoch 7 完成: 訓練=47.14%, 驗證=48.75%, 時間=314.0s
   💾 新最佳模型已保存: 驗證準確率 48.75%

Epoch 8/50, LR: 0.002858
   批次 20/157: 損失=1.5110, 準確率=49.92%
   批次 40/157: 損失=1.5057, 準確率=49.57%
   批次 60/157: 損失=1.5042, 準確率=49.38%
   批次 80/157: 損失=1.4945, 準確率=50.08%
   批次 100/157: 損失=1.4936, 準確率=50.41%
   批次 120/157: 損失=1.4945, 準確率=50.34%
   批次 140/157: 損失=1.4953, 準確率=50.23%
Epoch 8 完成: 訓練=50.09%, 驗證=48.90%, 時間=318.4s
   💾 新最佳模型已保存: 驗證準確率 48.90%

Epoch 9/50, LR: 0.002815
   批次 20/157: 損失=1.4308, 準確率=51.64%
   批次 40/157: 損失=1.4706, 準確率=51.02%
   批次 60/157: 損失=1.4701, 準確率=50.73%
   批次 80/157: 損失=1.4711, 準確率=50.39%
   批次 100/157: 損失=1.4654, 準確率=50.70%
   批次 120/157: 損失=1.4724, 準確率=50.40%
   批次 140/157: 損失=1.4671, 準確率=50.45%
Epoch 9 完成: 訓練=50.71%, 驗證=52.65%, 時間=321.3s
   💾 新最佳模型已保存: 驗證準確率 52.65%

Epoch 10/50, LR: 0.002767
   批次 20/157: 損失=1.3869, 準確率=54.92%
   批次 40/157: 損失=1.3974, 準確率=54.34%
   批次 60/157: 損失=1.4005, 準確率=53.62%
   批次 80/157: 損失=1.4104, 準確率=53.09%
   批次 100/157: 損失=1.4154, 準確率=53.09%
   批次 120/157: 損失=1.4090, 準確率=53.48%
   批次 140/157: 損失=1.4058, 準確率=53.52%
Epoch 10 完成: 訓練=53.42%, 驗證=52.20%, 時間=320.3s

Epoch 11/50, LR: 0.002714
   批次 20/157: 損失=1.3425, 準確率=57.73%
   批次 40/157: 損失=1.3544, 準確率=56.17%
   批次 60/157: 損失=1.3724, 準確率=55.62%
   批次 80/157: 損失=1.3729, 準確率=56.02%
   批次 100/157: 損失=1.3717, 準確率=55.91%
   批次 120/157: 損失=1.3721, 準確率=55.77%
   批次 140/157: 損失=1.3676, 準確率=56.10%
Epoch 11 完成: 訓練=55.83%, 驗證=53.75%, 時間=318.4s
   💾 新最佳模型已保存: 驗證準確率 53.75%

Epoch 12/50, LR: 0.002657
   批次 20/157: 損失=1.3173, 準確率=58.98%
   批次 40/157: 損失=1.2981, 準確率=58.59%
   批次 60/157: 損失=1.3154, 準確率=57.86%
   批次 80/157: 損失=1.3167, 準確率=58.20%
   批次 100/157: 損失=1.3230, 準確率=57.97%
   批次 120/157: 損失=1.3148, 準確率=58.11%
   批次 140/157: 損失=1.3150, 準確率=57.99%
Epoch 12 完成: 訓練=57.49%, 驗證=53.15%, 時間=314.9s

Epoch 13/50, LR: 0.002595
   批次 20/157: 損失=1.2701, 準確率=59.77%
   批次 40/157: 損失=1.2873, 準確率=59.14%
   批次 60/157: 損失=1.2794, 準確率=59.56%
   批次 80/157: 損失=1.2781, 準確率=59.65%
   批次 100/157: 損失=1.2850, 準確率=59.06%
   批次 120/157: 損失=1.2860, 準確率=59.28%
   批次 140/157: 損失=1.2901, 準確率=59.45%
Epoch 13 完成: 訓練=59.37%, 驗證=55.60%, 時間=316.0s
   💾 新最佳模型已保存: 驗證準確率 55.60%

Epoch 14/50, LR: 0.002528
   批次 20/157: 損失=1.2033, 準確率=62.73%
   批次 40/157: 損失=1.2221, 準確率=61.45%
   批次 60/157: 損失=1.2241, 準確率=61.46%
   批次 80/157: 損失=1.2306, 準確率=61.43%
   批次 100/157: 損失=1.2320, 準確率=61.41%
   批次 120/157: 損失=1.2286, 準確率=61.41%
   批次 140/157: 損失=1.2416, 準確率=61.00%
Epoch 14 完成: 訓練=60.82%, 驗證=56.15%, 時間=314.9s
   💾 新最佳模型已保存: 驗證準確率 56.15%

Epoch 15/50, LR: 0.002458
   批次 20/157: 損失=1.1894, 準確率=62.97%
   批次 40/157: 損失=1.2010, 準確率=62.42%
   批次 60/157: 損失=1.2140, 準確率=62.08%
   批次 80/157: 損失=1.2090, 準確率=62.50%
   批次 100/157: 損失=1.2190, 準確率=62.11%
   批次 120/157: 損失=1.2144, 準確率=62.24%
   批次 140/157: 損失=1.2133, 準確率=62.42%
Epoch 15 完成: 訓練=62.36%, 驗證=55.90%, 時間=321.2s
   📊 訓練-驗證差異: 6.46%

Epoch 16/50, LR: 0.002384
   批次 20/157: 損失=1.1652, 準確率=65.94%
   批次 40/157: 損失=1.1866, 準確率=64.92%
   批次 60/157: 損失=1.1830, 準確率=65.08%
   批次 80/157: 損失=1.1781, 準確率=65.02%
   批次 100/157: 損失=1.1885, 準確率=64.39%
   批次 120/157: 損失=1.1871, 準確率=64.43%
   批次 140/157: 損失=1.1896, 準確率=64.11%
Epoch 16 完成: 訓練=63.97%, 驗證=56.35%, 時間=322.6s
   📊 訓練-驗證差異: 7.62%
   💾 新最佳模型已保存: 驗證準確率 56.35%

Epoch 17/50, LR: 0.002306
   批次 20/157: 損失=1.1318, 準確率=66.64%
   批次 40/157: 損失=1.1341, 準確率=66.45%
   批次 60/157: 損失=1.1503, 準確率=65.36%
   批次 80/157: 損失=1.1480, 準確率=65.55%
   批次 100/157: 損失=1.1456, 準確率=65.36%
   批次 120/157: 損失=1.1467, 準確率=65.43%
   批次 140/157: 損失=1.1443, 準確率=65.26%
Epoch 17 完成: 訓練=64.90%, 驗證=56.30%, 時間=316.1s
   📊 訓練-驗證差異: 8.60%

Epoch 18/50, LR: 0.002225
   批次 20/157: 損失=1.1288, 準確率=67.66%
   批次 40/157: 損失=1.1337, 準確率=66.45%
   批次 60/157: 損失=1.1300, 準確率=66.28%
   批次 80/157: 損失=1.1236, 準確率=66.27%
   批次 100/157: 損失=1.1149, 準確率=66.70%
   批次 120/157: 損失=1.1181, 準確率=66.59%
   批次 140/157: 損失=1.1159, 準確率=66.61%
Epoch 18 完成: 訓練=66.31%, 驗證=56.30%, 時間=316.8s
   ⚠️  過擬合警告: 差異 10.01% > 閾值 10.0% (1/8)
   📊 訓練-驗證差異: 10.01%

Epoch 19/50, LR: 0.002142
   批次 20/157: 損失=1.0550, 準確率=68.67%
   批次 40/157: 損失=1.0647, 準確率=68.16%
   批次 60/157: 損失=1.0599, 準確率=68.20%
   批次 80/157: 損失=1.0629, 準確率=68.20%
   批次 100/157: 損失=1.0682, 準確率=68.00%
   批次 120/157: 損失=1.0661, 準確率=68.03%
   批次 140/157: 損失=1.0699, 準確率=68.00%
Epoch 19 完成: 訓練=67.81%, 驗證=56.15%, 時間=318.2s
   ⚠️  過擬合警告: 差異 11.66% > 閾值 10.0% (2/8)
   📊 訓練-驗證差異: 11.66%

Epoch 20/50, LR: 0.002055
   批次 20/157: 損失=1.0255, 準確率=70.16%
   批次 40/157: 損失=1.0149, 準確率=70.86%
   批次 60/157: 損失=1.0246, 準確率=70.91%
   批次 80/157: 損失=1.0328, 準確率=70.68%
   批次 100/157: 損失=1.0303, 準確率=70.53%
   批次 120/157: 損失=1.0342, 準確率=70.07%
   批次 140/157: 損失=1.0400, 準確率=69.62%
Epoch 20 完成: 訓練=69.32%, 驗證=56.75%, 時間=319.2s
   ⚠️  過擬合警告: 差異 12.57% > 閾值 10.0% (3/8)
   📊 訓練-驗證差異: 12.57%
   💾 新最佳模型已保存: 驗證準確率 56.75%

Epoch 21/50, LR: 0.001967
   批次 20/157: 損失=0.9738, 準確率=73.52%
   批次 40/157: 損失=0.9791, 準確率=73.40%
   批次 60/157: 損失=0.9864, 準確率=72.94%
   批次 80/157: 損失=0.9959, 準確率=72.42%
   批次 100/157: 損失=1.0037, 準確率=71.75%
   批次 120/157: 損失=1.0106, 準確率=71.03%
   批次 140/157: 損失=1.0143, 準確率=70.95%
Epoch 21 完成: 訓練=70.96%, 驗證=56.35%, 時間=315.7s
   ⚠️  過擬合警告: 差異 14.61% > 閾值 10.0% (4/8)
   📊 訓練-驗證差異: 14.61%

Epoch 22/50, LR: 0.001877
   批次 20/157: 損失=0.9794, 準確率=72.03%
   批次 40/157: 損失=0.9607, 準確率=72.93%
   批次 60/157: 損失=0.9617, 準確率=73.05%
   批次 80/157: 損失=0.9715, 準確率=72.73%
   批次 100/157: 損失=0.9728, 準確率=72.56%
   批次 120/157: 損失=0.9727, 準確率=72.83%
   批次 140/157: 損失=0.9711, 準確率=72.89%
Epoch 22 完成: 訓練=72.66%, 驗證=57.45%, 時間=317.5s
   ⚠️  過擬合警告: 差異 15.21% > 閾值 10.0% (5/8)
   📊 訓練-驗證差異: 15.21%
   💾 新最佳模型已保存: 驗證準確率 57.45%

Epoch 23/50, LR: 0.001785
   批次 20/157: 損失=0.8952, 準確率=77.11%
   批次 40/157: 損失=0.8961, 準確率=76.80%
   批次 60/157: 損失=0.9074, 準確率=76.17%
   批次 80/157: 損失=0.9206, 準確率=75.49%
   批次 100/157: 損失=0.9229, 準確率=75.11%
   批次 120/157: 損失=0.9237, 準確率=74.95%
   批次 140/157: 損失=0.9270, 準確率=74.79%
Epoch 23 完成: 訓練=74.62%, 驗證=58.35%, 時間=318.0s
   ⚠️  過擬合警告: 差異 16.27% > 閾值 10.0% (6/8)
   📊 訓練-驗證差異: 16.27%
   💾 新最佳模型已保存: 驗證準確率 58.35%

Epoch 24/50, LR: 0.001692
   批次 20/157: 損失=0.8541, 準確率=77.27%
   批次 40/157: 損失=0.8821, 準確率=76.56%
   批次 60/157: 損失=0.8983, 準確率=76.54%
   批次 80/157: 損失=0.9032, 準確率=76.04%
   批次 100/157: 損失=0.9046, 準確率=75.75%
   批次 120/157: 損失=0.9059, 準確率=75.74%
   批次 140/157: 損失=0.9075, 準確率=75.87%
Epoch 24 完成: 訓練=75.60%, 驗證=58.45%, 時間=320.1s
   ⚠️  過擬合警告: 差異 17.15% > 閾值 10.0% (7/8)
   📊 訓練-驗證差異: 17.15%
   💾 新最佳模型已保存: 驗證準確率 58.45%

Epoch 25/50, LR: 0.001599
   批次 20/157: 損失=0.8072, 準確率=80.00%
   批次 40/157: 損失=0.8279, 準確率=79.73%
   批次 60/157: 損失=0.8451, 準確率=78.85%
   批次 80/157: 損失=0.8489, 準確率=78.79%
   批次 100/157: 損失=0.8497, 準確率=78.55%
   批次 120/157: 損失=0.8582, 準確率=78.03%
   批次 140/157: 損失=0.8665, 準確率=77.75%
Epoch 25 完成: 訓練=77.62%, 驗證=59.00%, 時間=316.2s
   ⚠️  過擬合警告: 差異 18.62% > 閾值 10.0% (8/8)
   🛑 過擬合早停: 連續 8 epochs 訓練-驗證差異超過 10.0%

⏱️ 超快速訓練時間統計:
   • 總訓練時間: 7950.7s (132.5min)
   • 實際訓練epochs: 25 / 50
   • 平均每epoch: 317.9s
   • 最佳驗證準確率: 58.45%
   • 早停原因: 過擬合檢測 (差異: 18.62%)
   • 已載入最佳模型權重

📈 繪製超快速訓練歷史...

📊 評估超縮小版模型...
   ✓ 整體準確率: 58.45%

🎉 超快速訓練完成!
   • 模型大小: L
   • 最終準確率: 58.45%
   • 總訓練時間: 132.5 分鐘
   • 平均每epoch: 317.9 秒