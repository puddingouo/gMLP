🚀 超縮小版 gMLP 圖像分類訓練開始
============================================================

📋 超縮小版 gMLP 模型架構比較:
=====================================================================================
模型       深度     維度       FFN倍數    參數(M)      過擬合風險
-------------------------------------------------------------------------------------
Nano     6      64       2        0.3        很低
XS       8      80       3        0.8        低
S        12     128      3        2.0        中等
M        16     160      4        4.5        較高
L        30     128      6        5.9        很高
-------------------------------------------------------------------------------------
🎯 建議（針對10K訓練樣本）:
   • Nano: 極速原型開發，最低過擬合風險 (<1分鐘訓練)
   • XS: 快速實驗，低過擬合風險 (~2分鐘訓練) ⭐推薦
   • S: 平衡性能與速度，中等過擬合風險 (~5分鐘訓練)
   • M: 較好性能但過擬合風險較高 (~10分鐘訓練)
   • L: 最大模型，很高過擬合風險，不建議用於小數據集
📦 加載超快速 CIFAR-10 數據集...
   🚀 超快速模式：小規模數據集訓練
   ✓ 訓練樣本: 10000
   ✓ 測試樣本: 2000
   ✓ Batch大小: 64

🏗️ 創建超縮小版 gMLP-XS 模型...
   ⚡ CPU模式：已設置4個線程
   ✓ 超縮小版 gMLP-XS 模型創建完成
   ✓ 設備: cpu
   ✓ 參數數量: 274,330 (0.27M)
   ✓ 目標參數: 0.8M
   ✓ 模型大小: 1.0 MB
   ✓ 架構: depth=8, dim=80, ff_mult=3

🏋️ 開始超快速訓練 (50 個 epochs)...
   🛡️  啟用過擬合早停保護

Epoch 1/50, LR: 0.003000
   批次 20/157: 損失=2.1676, 準確率=19.53%
   批次 40/157: 損失=2.0734, 準確率=24.30%
   批次 60/157: 損失=2.0304, 準確率=26.20%
   批次 80/157: 損失=1.9846, 準確率=28.09%
   批次 100/157: 損失=1.9399, 準確率=30.19%
   批次 120/157: 損失=1.9129, 準確率=31.15%
   批次 140/157: 損失=1.8841, 準確率=32.20%
Epoch 1 完成: 訓練=32.93%, 驗證=42.15%, 時間=37.4s
   💾 新最佳模型已保存: 驗證準確率 42.15%

Epoch 2/50, LR: 0.002997
   批次 20/157: 損失=1.6888, 準確率=41.17%
   批次 40/157: 損失=1.6581, 準確率=42.34%
   批次 60/157: 損失=1.6533, 準確率=41.80%
   批次 80/157: 損失=1.6387, 準確率=41.97%
   批次 100/157: 損失=1.6336, 準確率=42.25%
   批次 120/157: 損失=1.6207, 準確率=42.97%
   批次 140/157: 損失=1.6111, 準確率=43.67%
Epoch 2 完成: 訓練=43.95%, 驗證=46.50%, 時間=37.8s
   💾 新最佳模型已保存: 驗證準確率 46.50%

Epoch 3/50, LR: 0.002988
   批次 20/157: 損失=1.5228, 準確率=47.89%
   批次 40/157: 損失=1.5159, 準確率=48.28%
   批次 60/157: 損失=1.5185, 準確率=48.10%
   批次 80/157: 損失=1.5228, 準確率=47.99%
   批次 100/157: 損失=1.5155, 準確率=48.42%
   批次 120/157: 損失=1.5218, 準確率=47.97%
   批次 140/157: 損失=1.5137, 準確率=48.24%
Epoch 3 完成: 訓練=48.31%, 驗證=49.75%, 時間=35.4s
   💾 新最佳模型已保存: 驗證準確率 49.75%

Epoch 4/50, LR: 0.002974
   批次 20/157: 損失=1.4597, 準確率=50.94%
   批次 40/157: 損失=1.4299, 準確率=51.60%
   批次 60/157: 損失=1.4385, 準確率=52.03%
   批次 80/157: 損失=1.4367, 準確率=52.09%
   批次 100/157: 損失=1.4399, 準確率=51.94%
   批次 120/157: 損失=1.4389, 準確率=51.89%
   批次 140/157: 損失=1.4413, 準確率=51.86%
Epoch 4 完成: 訓練=52.01%, 驗證=51.80%, 時間=34.2s
   💾 新最佳模型已保存: 驗證準確率 51.80%

Epoch 5/50, LR: 0.002953
   批次 20/157: 損失=1.3907, 準確率=55.23%
   批次 40/157: 損失=1.3659, 準確率=56.09%
   批次 60/157: 損失=1.3821, 準確率=54.79%
   批次 80/157: 損失=1.3734, 準確率=55.39%
   批次 100/157: 損失=1.3681, 準確率=55.47%
   批次 120/157: 損失=1.3742, 準確率=55.01%
   批次 140/157: 損失=1.3717, 準確率=55.39%
Epoch 5 完成: 訓練=55.49%, 驗證=54.15%, 時間=35.5s
   💾 新最佳模型已保存: 驗證準確率 54.15%

Epoch 6/50, LR: 0.002927
   批次 20/157: 損失=1.3435, 準確率=56.56%
   批次 40/157: 損失=1.3398, 準確率=57.15%
   批次 60/157: 損失=1.3352, 準確率=57.16%
   批次 80/157: 損失=1.3207, 準確率=57.75%
   批次 100/157: 損失=1.3213, 準確率=57.67%
   批次 120/157: 損失=1.3213, 準確率=57.45%
   批次 140/157: 損失=1.3259, 準確率=57.22%
Epoch 6 完成: 訓練=57.31%, 驗證=57.35%, 時間=35.8s
   💾 新最佳模型已保存: 驗證準確率 57.35%

Epoch 7/50, LR: 0.002895
   批次 20/157: 損失=1.2550, 準確率=60.16%
   批次 40/157: 損失=1.2648, 準確率=59.88%
   批次 60/157: 損失=1.2672, 準確率=59.22%
   批次 80/157: 損失=1.2617, 準確率=59.65%
   批次 100/157: 損失=1.2544, 準確率=59.88%
   批次 120/157: 損失=1.2572, 準確率=59.93%
   批次 140/157: 損失=1.2600, 準確率=59.70%
Epoch 7 完成: 訓練=60.02%, 驗證=58.30%, 時間=34.8s
   💾 新最佳模型已保存: 驗證準確率 58.30%

Epoch 8/50, LR: 0.002858
   批次 20/157: 損失=1.1985, 準確率=63.83%
   批次 40/157: 損失=1.1963, 準確率=63.09%
   批次 60/157: 損失=1.1978, 準確率=62.99%
   批次 80/157: 損失=1.2068, 準確率=62.42%
   批次 100/157: 損失=1.2020, 準確率=62.50%
   批次 120/157: 損失=1.2027, 準確率=62.62%
   批次 140/157: 損失=1.2051, 準確率=62.52%
Epoch 8 完成: 訓練=62.24%, 驗證=59.35%, 時間=33.6s
   💾 新最佳模型已保存: 驗證準確率 59.35%

Epoch 9/50, LR: 0.002815
   批次 20/157: 損失=1.1849, 準確率=63.28%
   批次 40/157: 損失=1.1578, 準確率=64.41%
   批次 60/157: 損失=1.1610, 準確率=64.27%
   批次 80/157: 損失=1.1669, 準確率=63.77%
   批次 100/157: 損失=1.1730, 準確率=63.56%
   批次 120/157: 損失=1.1713, 準確率=63.71%
   批次 140/157: 損失=1.1732, 準確率=63.66%
Epoch 9 完成: 訓練=63.54%, 驗證=60.20%, 時間=34.2s
   💾 新最佳模型已保存: 驗證準確率 60.20%

Epoch 10/50, LR: 0.002767
   批次 20/157: 損失=1.0660, 準確率=67.50%
   批次 40/157: 損失=1.0945, 準確率=67.15%
   批次 60/157: 損失=1.1049, 準確率=66.22%
   批次 80/157: 損失=1.1282, 準確率=65.51%
   批次 100/157: 損失=1.1281, 準確率=65.55%
   批次 120/157: 損失=1.1310, 準確率=65.33%
   批次 140/157: 損失=1.1334, 準確率=65.36%
Epoch 10 完成: 訓練=65.16%, 驗證=60.80%, 時間=34.2s
   💾 新最佳模型已保存: 驗證準確率 60.80%

Epoch 11/50, LR: 0.002714
   批次 20/157: 損失=1.1249, 準確率=66.02%
   批次 40/157: 損失=1.0927, 準確率=67.27%
   批次 60/157: 損失=1.1052, 準確率=66.85%
   批次 80/157: 損失=1.1023, 準確率=66.72%
   批次 100/157: 損失=1.1004, 準確率=67.08%
   批次 120/157: 損失=1.1041, 準確率=66.88%
   批次 140/157: 損失=1.0985, 準確率=66.88%
Epoch 11 完成: 訓練=67.21%, 驗證=62.55%, 時間=40.1s
   💾 新最佳模型已保存: 驗證準確率 62.55%

Epoch 12/50, LR: 0.002657
   批次 20/157: 損失=1.0338, 準確率=69.61%
   批次 40/157: 損失=1.0305, 準確率=69.96%
   批次 60/157: 損失=1.0320, 準確率=70.16%
   批次 80/157: 損失=1.0331, 準確率=70.14%
   批次 100/157: 損失=1.0447, 準確率=69.64%
   批次 120/157: 損失=1.0509, 準確率=69.32%
   批次 140/157: 損失=1.0533, 準確率=69.03%
Epoch 12 完成: 訓練=68.86%, 驗證=62.85%, 時間=46.2s
   📊 訓練-驗證差異: 6.01%
   💾 新最佳模型已保存: 驗證準確率 62.85%

Epoch 13/50, LR: 0.002595
   批次 20/157: 損失=1.0321, 準確率=70.47%
   批次 40/157: 損失=1.0254, 準確率=70.51%
   批次 60/157: 損失=1.0240, 準確率=70.62%
   批次 80/157: 損失=1.0115, 準確率=70.64%
   批次 100/157: 損失=1.0110, 準確率=70.73%
   批次 120/157: 損失=1.0108, 準確率=70.73%
   批次 140/157: 損失=1.0122, 準確率=70.75%
Epoch 13 完成: 訓練=70.56%, 驗證=62.60%, 時間=44.0s
   📊 訓練-驗證差異: 7.96%

Epoch 14/50, LR: 0.002528
   批次 20/157: 損失=0.9487, 準確率=73.36%
   批次 40/157: 損失=0.9613, 準確率=72.19%
   批次 60/157: 損失=0.9762, 準確率=71.67%
   批次 80/157: 損失=0.9785, 準確率=71.62%
   批次 100/157: 損失=0.9761, 準確率=71.86%
   批次 120/157: 損失=0.9820, 準確率=71.63%
   批次 140/157: 損失=0.9838, 準確率=71.44%
Epoch 14 完成: 訓練=71.26%, 驗證=63.15%, 時間=37.5s
   ⚠️  過擬合警告: 差異 8.11% > 閾值 8.0% (1/6)
   📊 訓練-驗證差異: 8.11%
   💾 新最佳模型已保存: 驗證準確率 63.15%

Epoch 15/50, LR: 0.002458
   批次 20/157: 損失=0.9578, 準確率=72.89%
   批次 40/157: 損失=0.9709, 準確率=72.66%
   批次 60/157: 損失=0.9709, 準確率=72.24%
   批次 80/157: 損失=0.9584, 準確率=72.99%
   批次 100/157: 損失=0.9584, 準確率=72.75%
   批次 120/157: 損失=0.9490, 準確率=72.99%
   批次 140/157: 損失=0.9523, 準確率=72.92%
Epoch 15 完成: 訓練=72.97%, 驗證=63.30%, 時間=43.4s
   ⚠️  過擬合警告: 差異 9.67% > 閾值 8.0% (2/6)
   📊 訓練-驗證差異: 9.67%
   💾 新最佳模型已保存: 驗證準確率 63.30%

Epoch 16/50, LR: 0.002384
   批次 20/157: 損失=0.9207, 準確率=74.38%
   批次 40/157: 損失=0.9120, 準確率=74.69%
   批次 60/157: 損失=0.9037, 準確率=75.23%
   批次 80/157: 損失=0.9118, 準確率=74.77%
   批次 100/157: 損失=0.9187, 準確率=74.83%
   批次 120/157: 損失=0.9177, 準確率=74.77%
   批次 140/157: 損失=0.9231, 準確率=74.59%
Epoch 16 完成: 訓練=74.70%, 驗證=64.65%, 時間=40.9s
   ⚠️  過擬合警告: 差異 10.05% > 閾值 8.0% (3/6)
   📊 訓練-驗證差異: 10.05%
   💾 新最佳模型已保存: 驗證準確率 64.65%

Epoch 17/50, LR: 0.002306
   批次 20/157: 損失=0.8712, 準確率=77.50%
   批次 40/157: 損失=0.8696, 準確率=77.70%
   批次 60/157: 損失=0.8771, 準確率=77.03%
   批次 80/157: 損失=0.8867, 準確率=76.54%
   批次 100/157: 損失=0.8885, 準確率=76.45%
   批次 120/157: 損失=0.8821, 準確率=76.59%
   批次 140/157: 損失=0.8853, 準確率=76.42%
Epoch 17 完成: 訓練=76.11%, 驗證=63.95%, 時間=37.0s
   ⚠️  過擬合警告: 差異 12.16% > 閾值 8.0% (4/6)
   📊 訓練-驗證差異: 12.16%

Epoch 18/50, LR: 0.002225
   批次 20/157: 損失=0.8342, 準確率=77.42%
   批次 40/157: 損失=0.8346, 準確率=77.93%
   批次 60/157: 損失=0.8434, 準確率=77.27%
   批次 80/157: 損失=0.8408, 準確率=77.68%
   批次 100/157: 損失=0.8443, 準確率=77.17%
   批次 120/157: 損失=0.8495, 準確率=77.08%
   批次 140/157: 損失=0.8483, 準確率=77.12%
Epoch 18 完成: 訓練=76.85%, 驗證=64.10%, 時間=43.1s
   ⚠️  過擬合警告: 差異 12.75% > 閾值 8.0% (5/6)
   📊 訓練-驗證差異: 12.75%

Epoch 19/50, LR: 0.002142
   批次 20/157: 損失=0.7638, 準確率=82.11%
   批次 40/157: 損失=0.7763, 準確率=81.72%
   批次 60/157: 損失=0.7846, 準確率=81.02%
   批次 80/157: 損失=0.7908, 準確率=80.86%
   批次 100/157: 損失=0.8064, 準確率=79.95%
   批次 120/157: 損失=0.8114, 準確率=79.77%
   批次 140/157: 損失=0.8136, 準確率=79.48%
Epoch 19 完成: 訓練=79.26%, 驗證=62.90%, 時間=42.4s
   ⚠️  過擬合警告: 差異 16.36% > 閾值 8.0% (6/6)
   🛑 過擬合早停: 連續 6 epochs 訓練-驗證差異超過 8.0%

⏱️ 超快速訓練時間統計:
   • 總訓練時間: 727.9s (12.1min)
   • 實際訓練epochs: 19 / 50
   • 平均每epoch: 38.3s
   • 最佳驗證準確率: 64.65%
   • 早停原因: 過擬合檢測 (差異: 16.36%)
   • 已載入最佳模型權重

📈 繪製超快速訓練歷史...

📊 評估超縮小版模型...
   ✓ 整體準確率: 64.65%

🎉 超快速訓練完成!
   • 模型大小: XS
   • 最終準確率: 64.65%
   • 總訓練時間: 12.1 分鐘
   • 平均每epoch: 38.3 秒